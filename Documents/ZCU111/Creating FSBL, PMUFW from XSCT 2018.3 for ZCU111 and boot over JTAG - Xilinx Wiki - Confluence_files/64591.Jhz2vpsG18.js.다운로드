"use strict";(self._cf=self._cf||[]).push([[64591],{878526:(e,t,n)=>{n.r(t),n.d(t,{ReadTime:()=>_,ReadTimeLoader:()=>F,calculateEstimatedReadTime:()=>L});var r=n(122551),a=n(499082),o=n(325834),l=n(961634),c=n(184786),i=n(526938),u=n(991332),d=n(790632),s=n(464984),m=n(883383),f=n(612642),p=n(57198),g=n(259220),y=n(172033),b=n(202049);const E=(0,y.is)({key:b.km}),v=(0,s.defineMessages)({readTime:{id:"read-time.by-line.estimated-read-time",defaultMessage:"{readTime} min read"},tooltipDescription:{id:"read-time.tooltip-description",defaultMessage:"Estimated read time"}}),Z=(0,d.Z)("span",{target:"evl2q7h0"})("margin-right:5px;padding-left:3px;color:",(0,f.Z)("color.text.subtlest","--ds-text-subtlest"),';&:before{content:"â€¢";display:inline-block;color:',(0,f.Z)("color.text.subtlest","--ds-text-subtlest"),";padding-right:8px;text-decoration:none;}");function h({pageId:e,readTime:t}){const{createAnalyticsEvent:n}=(0,o._)(),a=(0,r.useCallback)((()=>{n({type:"sendUIEvent",data:{source:"page",action:"displayed",actionSubject:"tooltip",actionSubjectId:"estimatedReadTime"}}).fire()}),[n]);return(0,r.useEffect)((()=>{t&&n({type:"sendTrackEvent",data:{source:"confluence-frontend",action:"displayed",actionSubject:"readTime",actionSubjectId:e,attributes:{readTime:t}}}).fire()}),[e,t,n]),r.createElement(r.Fragment,null,r.createElement(Z,null,r.createElement(p.Z,{tag:"span",content:r.createElement(m.Z,(0,u.Z)({},v.tooltipDescription)),onShow:a},r.createElement(m.Z,(0,u.Z)((0,u.Z)({},v.readTime),{},{values:{readTime:t}})))),r.createElement(g.M,{metric:E}))}var C=n(288809);const T=e=>{if(e){const t=e.match(/\S+/g);if(t)return t.length}return 0},I=e=>{const t={rawLength:JSON.stringify(e).length,textLength:0,wordCount:0,imageCount:0,inlineMacroCount:0,macroCount:0,tableCount:0};return(0,C.u)(e,((e,t)=>{switch(t.type){case"text":return(0,u.Z)((0,u.Z)({},e),{},{textLength:e.textLength+(t.text?t.text.length:0),wordCount:e.wordCount+T(t.text)});case"media":return(0,u.Z)((0,u.Z)({},e),{},{imageCount:e.imageCount+1});case"inlineExtension":return(0,u.Z)((0,u.Z)({},e),{},{inlineMacroCount:e.macroCount+1});case"extension":return(0,u.Z)((0,u.Z)({},e),{},{macroCount:e.macroCount+1});case"table":return(0,u.Z)((0,u.Z)({},e),{},{tableCount:e.tableCount+1})}return e}),t)};var x=n(331377);const S=x.ZP`query ReadTimeQuery($contentId:ID){content(id:$contentId){nodes{id type body{dynamic{value representation}}}}}`,M=x.ZP`query ReadTimeSmartsQuery($id:ID!){getSmartContentFeature(contentId:$id){readTime}}`,w=e=>{var t;if("atlas_doc_format"===(null!=(t=e)&&null!=(t=t.content)&&null!=(t=t.nodes)&&null!=(t=t[0])&&null!=(t=t.body)&&null!=(t=t.dynamic)?t.representation:t)){var n;const t=null!=(n=e)&&null!=(n=n.content)&&null!=(n=n.nodes)&&null!=(n=n[0])&&null!=(n=n.body)&&null!=(n=n.dynamic)?n.value:n;if(t)try{return JSON.parse(t)}catch(r){return null}}return null},R=({contentId:e})=>{const{createAnalyticsEvent:t}=(0,o._)(),{data:n,loading:i,error:u}=(0,a.aM)(S,{variables:{contentId:e},fetchPolicy:"cache-only"});(0,r.useEffect)((()=>{var r;const a=w(n);if(!t||!a||i||u||!e)return;const o=null!=(r=n)&&null!=(r=r.content)&&null!=(r=r.nodes)&&null!=(r=r[0])?r.type:r;t({type:"sendOperationalEvent",data:{source:"confluence-frontend",action:"extracted",actionSubject:"contentFeature",objectType:o,objectId:e,attributes:I(a)}}).fire()}),[e,i,n,u,t]);const d=(0,r.useMemo)((()=>{const t=w(n);if(!t||i||u||!e)return null;const r=I(t);return L(r)}),[i,u,n,e]),s=(0,c.i0)().locale,m=s&&"en"===s.substring(0,2).toLowerCase();return d&&m?r.createElement(h,{readTime:d,pageId:e}):u?r.createElement(l.X,{error:u}):null},j=({contentId:e})=>{var t;const n=(0,c.i0)().locale,o=n&&"en"===n.substring(0,2).toLowerCase(),{data:i,loading:u,error:d}=(0,a.aM)(M,{variables:{id:e},errorPolicy:"all",fetchPolicy:"cache-first"}),s=null==i||null===(t=i.getSmartContentFeature)||void 0===t?void 0:t.readTime;return u?null:null==s||!o||d?r.createElement(r.Fragment,null,r.createElement(R,{contentId:e}),d&&r.createElement(l.X,{error:d})):r.createElement(h,{readTime:s,pageId:e})};j.displayName="SmartsReadTime";const L=e=>Math.ceil((e.wordCount/265*60+(e=>{let t=0;for(let n=0;n<e;n++)t+=Math.max(12-n,3);return t})(e.imageCount))/60),F=({contentId:e})=>r.createElement(r.Fragment,null,r.createElement(i.q,{metric:E}),r.createElement(_,{contentId:e})),_=({contentId:e})=>r.createElement(j,{contentId:e});_.displayName="ReadTime"},288809:(e,t,n)=>{n.d(t,{u:()=>a});var r=n(755181);function a(e,t,n){let a=n;return(0,r.f)(e,{any:e=>{a=t(a,e)}}),a}},755181:(e,t,n)=>{n.d(t,{f:()=>a});var r=n(991332);function a(e,t){return o(e,{node:void 0},t,0,0)}function o(e,t,n,a,l){const c=n[e.type]||n.any;let i=(0,r.Z)({},e);if(c){const n=c((0,r.Z)({},i),t,a,l);if(!1===n)return!1;i=n||e}return i.content&&(i.content=i.content.reduce(((e,r,a)=>{if(!r)return e;const c=o(r,{node:i,parent:t},n,a,l+1);return!1!==c&&e.push(c),e}),[])),i}}}]);
//# sourceMappingURL=64591.Jhz2vpsG18.js.map