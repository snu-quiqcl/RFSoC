WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.plugins.share-page:autocomplete', location = 'js/autocomplete.js' */
define("confluence-share-page-plugin/js/autocomplete",["ajs"],function(a){return{autocomplete:function(e){e=e||document.body;var f=a.$,b=/^([a-zA-Z0-9_\.\-\+\!#\$%&'\*/=\?\^_`{|}~])+\@.*/;var d=function(k){if(!k||!k.result){throw new Error("Invalid JSON format")}var g=[];for(var h=0;h<k.result.length;h++){var j=k.result[h];if(j.type=="group"){j=c(j)}}g.push(k.result);return g};function c(g){if(g.name=="confluence-users"||g.name=="confluence-administrators"){return g}g.title=g.name;g.group=g.name;g.thumbnailLink={href:Confluence.getContextPath()+"/download/resources/com.atlassian.confluence.plugins.share-page:mail-page-resources/images/group.png",type:"image/png",rel:"thumbnail"};g.link=[{href:Confluence.getContextPath(),rel:"self"}];return g}f("input.autocomplete-sharepage[data-autocomplete-user-bound!=true]",e).each(function(){var i=f(this).attr("data-autocomplete-sharepage-bound","true").attr("autocomplete","off");var h=i.attr("data-max")||10,k=i.attr("data-alignment")||"left",j=i.attr("data-dropdown-target"),g=null;if(j){g=f(j)}else{g=f("<div></div>");i.after(g)}g.addClass("aui-dd-parent autocomplete");i.quicksearch(a.REST.getBaseUrl()+"search/user-or-group.json",function(){i.trigger("open.autocomplete-sharepage")},{makeParams:function(l){return{"max-results":h,query:l.replace("{|}","")}},dropdownPlacement:function(l){g.append(l)},makeRestMatrixFromData:d,addDropdownData:function(m){var l=f.trim(i.val());if(b.test(l)){m.push([{name:l,email:l,href:"#",icon:Confluence.getContextPath()+"/download/resources/com.atlassian.confluence.plugins.share-page:mail-page-resources/images/envelope.png"}])}if(!m.length){var n=i.attr("data-none-message");if(n){m.push([{name:n,className:"no-results",href:"#"}])}}return m},ajsDropDownOptions:{alignment:k,displayHandler:function(l){return l.name},selectionHandler:function(n,m){if(m.find(".search-for").length){i.trigger("selected.autocomplete-sharepage",{searchFor:i.val()});return}if(m.find(".no-results").length){this.hide();n.preventDefault();return}var l=f("span:eq(0)",m).data("properties");if(!l.email){l=l.restObj}i.trigger("selected.autocomplete-sharepage",{content:l});this.hide();n.preventDefault()}}})})}}});
}catch(e){WRMCB(e)};