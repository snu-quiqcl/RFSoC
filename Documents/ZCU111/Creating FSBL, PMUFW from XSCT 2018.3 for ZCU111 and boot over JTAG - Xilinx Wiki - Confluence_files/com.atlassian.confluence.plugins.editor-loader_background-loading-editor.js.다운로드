WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.plugins.editor-loader:background-loading-editor', location = 'jscripts/editor-loader.js' */
define("confluence-editor-loader/editor-loader","jquery confluence/meta confluence/api/event confluence/aui-overrides confluence/legacy-editor-global-AVOID-IF-POSSIBLE confluence/dark-features ajs wrm window confluence/performance-session".split(" "),function(b,f,v,p,q,r,d,w,x,t){function y(a){var g=b.ajaxSettings.cache;try{b.ajaxSettings.cache=!0,a()}finally{b.ajaxSettings.cache=g}}var c,u,z=b("#confluence-ui").length,A=function(a){var g=[];b("\x3cdiv /\x3e").html(a).find("meta").each(function(a,
d){a=b(d);d=a.attr("name").substr(4);var c=a.attr("content"),h=b('meta[name\x3d"ajs-'+d+'"]');0<h.length?h.attr("content",c):g.push(a[0].outerHTML);f.set(d,"true"===c||"false"===c?"true"===c:c)});g.length&&b("head").append(g.join(""));p.metaToParams()},k={_listening:!1,_queuedHandlers:[],_watchHandler:function(){q.UI.toggleWatchPage(!1)},_unwatchHandler:function(){q.UI.toggleWatchPage(!0)},_createQueueAdder:function(a){return function(){k._listening&&k._queuedHandlers.push(a)}},bind:function(){d.bind("watchpage.pageoperation",
this._createQueueAdder(this._watchHandler));d.bind("unwatchpage.pageoperation",this._createQueueAdder(this._unwatchHandler))},setListening:function(a){this._listening=a},applyHandlers:function(){for(var a=this._queuedHandlers.pop();a;)a(),a=this._queuedHandlers.pop()}};k.setListening(!0);k.bind();var B=function(a,b){if(c)return c.fail(function(){b?b.call(this,arguments):d.log("EditorLoader: loadGuard - previous load failed.")}),c.done(function(){a?c.done(function(){setTimeout(a,0)}):d.log("EditorLoader: loadGuard - editor is already loaded.")}),
!0},C=function(){var a=m(),b=n();return!a||a&&b.attr("data-contentId")!==f.get("page-id")},m=function(){return b("#editor-preload-container").length},n=function(){var a=b("#editor-preload-container"),d=f.get("page-id");m()||(a=b('\x3cdiv id\x3d"editor-preload-container" style\x3d"display: none;" data-contentId\x3d"'+d+'"\x3e\x3c/div\x3e'));return a},D=function(){d.debug("Waiting for frontend editor plugins resources.");if(!d.DarkFeatures.isEnabled("frontend.editor.plugins"))return b.Deferred().resolve();
var a=b.Deferred();d.bind("frontend.editor.plugins.resources.loaded",function(){d.debug("Resolving frontend editor plugins resources.");a.resolve()});return a},e;return{getPreloadContainer:n,getEditorPreloadMarkup:function(a){if(e&&!a)return e;e&&4!==e.readyState&&e.abort();t.debugTime("confluence.editor.preload");a=d.contextPath()+"/plugins/editor-loader/editor.action";return e=b.get(a,{parentPageId:f.get("parent-page-id"),pageId:f.get("page-id"),contentId:f.get("content-id"),spaceKey:f.get("space-key"),
atl_after_login_redirect:x.location.pathname,timeout:d.Confluence.EditorLoader.loadingTimeout})},resourcesLoaded:function(){return c&&"resolved"===c.state()},loadingTimeout:12E3,isEditorActive:function(){var a=b("#editor-preload-container");return a.length&&a.is(":visible")},load:function(a,g,e){var k=e||{editPermission:!0};if((e=C())||!B(a,g)){c=new b.Deferred;u=D();a&&c.done(a);g&&c.fail(g);var l=n();m()?(l.attr("data-contentId",f.get("page-id")),l.empty()):b("body").append(l);var h=new b.Deferred;
f.get("page-id")?this.getEditorPreloadMarkup(e).done(function(a,c,e){"success"===c||"notmodified"===c?(y(function(){l.append(a)}),z?(c=l.find("#dynamic-editor-metadata-template").text(),A(c)):(c=d.renderTemplate("dynamic-editor-metadata"),b("head").append(c),p.metaToParams()),d.debug("EditorLoader: Finished loading the editor template."),h.resolve(),t.debugTimeEnd("confluence.editor.preload")):h.reject("Error loading the Editor template: "+e.status+" - "+e.statusText)}):h.resolve();a=r.isEnabled("fd-87.editor.spa")&&
!r.isEnabled("fd-87.editor.spa.disabled")?b.Deferred().resolve():w.require(["wrc!editor","wrc!macro-browser","wrc!fullpage-editor"]).fail(function(a){d.logError("Failed to load editor resources",a)});b.when(h,a,u).done(function(){d.debug("EditorLoader: Finished loading the editor.");c.resolve();v.trigger("rte-loaded",k)}).fail(function(){c.reject(arguments)})}},getEditorForm:function(){if(this.isEditorActive()){var a=require("tinymce");return b(a.activeEditor.getContainer()).closest("form")}return null},
getEditorLoadingStatus:function(){return c}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor-loader/editor-loader","AJS.Confluence.EditorLoader");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.editor-loader:background-loading-editor', location = 'jscripts/block-and-buffer-keys.js' */
define("confluence-editor-loader/block-and-buffer-keys",[],function(){return{block:function(e){var d=[],f=function(a){a.preventDefault();a.stopPropagation();var b=a.which;b||(b=a.charCode?a.charCode:a.keyCode);13!==b&&48>b||d.push(b);a.preventDefault()};e.keypress(f);return function(){e.unbind("keypress",f);for(var a="",b=0;b<d.length;b++){var c;c=d[b];65535<c?(c-=65536,c=String.fromCharCode(55296+(c>>10),56320+(c&1023))):c=String.fromCharCode(c);a+=c}return a}}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor-loader/block-and-buffer-keys","AJS.Confluence.BlockAndBuffer");
}catch(e){WRMCB(e)};