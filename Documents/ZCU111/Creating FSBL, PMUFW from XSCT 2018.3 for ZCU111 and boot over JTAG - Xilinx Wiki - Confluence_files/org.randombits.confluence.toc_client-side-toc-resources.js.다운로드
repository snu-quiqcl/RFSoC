WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'org.randombits.confluence.toc:client-side-toc-resources', location = 'net/customware/confluence/plugin/toc/js/client-side-toc.js' */
define("confluence-toc/js/client-side-toc",["ajs","confluence/api/event","jquery","underscore","skate","confluence/legacy","confluence/api/constants","confluence/get-content-id","confluence/api/connect-helper"],function(i,w,g,v,s,k,e,a,d){function o(y){var x=g({});x.data("precedenceLevel",y);return x}function f(x){return g(x).data("precedenceLevel")}function l(y,x){g(y).data("precedenceLevel",x);return y}function h(y,x){return x===f(y)}function m(E,x,z,B){if(E.length===0){return g()}E=E.filter(function(F){return g(F).closest(".pm-table-sticky-wrapper").length===0});var y=E.map(f).reduce(function(G,F){return Math.min(G,F)});if(!h(E[0],y)){E.unshift(o(y))}var C=x.createTocLevelContainer();var D={subElements:[],currentItem:undefined,outline:undefined,flush:function(){if(this.subElements.length>0&&this.currentItem){m(this.subElements,x,this.outline,B).appendTo(this.currentItem);this.subElements=[]}},add:function(F){this.subElements.push(F)},resetItem:function(F){this.outline=(z||[]).slice(0);this.outline.push(F);this.currentItem=x.createTocItemContainer();this.currentItem.appendTo(C);return this.currentItem},};var A=0;E.forEach(function(F){if(h(F,y)){A++;D.flush();D.resetItem(A);if(F.textContent){b(F,D.outline.join("."),B).appendTo(D.currentItem)}else{D.currentItem.addClass("toc-empty-item")}}else{D.add(F)}});D.flush();if(z.length===0&&x.decorateToc){x.decorateToc(C)}return C}function c(){g(this).replaceWith(i.escapeHtml(g(this).text()))}function p(){g(this).removeAttr("style")}function u(z,y){var x=g(z).clone();x.find(".heading-anchor-wrapper").remove();x.find(".inline-highlight").each(c);x.find("a").each(c);x.find('[data-renderer-mark="true"]').each(c);x.find(".inline-comment-marker").each(c);x.find("br").remove();if(!y){x.find("em").each(c);x.find("strong").each(c);x.find("u").each(c);x.find("s").each(c);x.find("sub").each(c);x.find("sup").each(c);x.find("code").each(c);x.find("span").each(p)}return x.html()}function b(y,z,x){return g(k.Plugins.TableOfContents.Client.tocItemBody({outline:z,linkHref:"#"+encodeURIComponent(y.id),linkText:u(y,x)}))}function r(x){return{createTocLevelContainer:function(){return this.createTocItemContainer()},createTocItemContainer:function(){return g(k.Plugins.TableOfContents.Client.flatStyleTocItemContainer({cssClass:"toc-item-container",}))},decorateToc:function(z){function y(C,A){var D=C in x?x[C]:A;if(D){var B=g(k.Plugins.TableOfContents.Client.flatStyleTocSeparator({separator:D,}));B.appendTo(z)}}y("preseparator","[ ");g(z).find("span.toc-item-body").each(function(A,B){if(A>0){y("midseparator"," ] [ ")}g(B).appendTo(z)});y("postseparator"," ]");g(z).find(".toc-item-container").remove()},}}function q(x){return{createTocLevelContainer:function(){return g(k.Plugins.TableOfContents.Client.listStyleTocLevelContainer({cssliststyle:x.cssliststyle,csslistindent:x.csslistindent,}))},createTocItemContainer:function(){return g(k.Plugins.TableOfContents.Client.listStyleTocItemContainer())},}}function n(x){var z;if(x.includeheaderregex){z=new RegExp(x.includeheaderregex)}var y;if(x.excludeheaderregex){y=new RegExp(x.excludeheaderregex)}return function(){var A=g(this).text();if(z&&!z.test(A)){return false}if(y&&y.test(A)){return false}return true}}function t(z,B){var x=B.headerelements;var D=x.split(",");var A=n(B);var C=B.isFabric;var y=g("#main-content").find(x).filter(A).filter(function(){return g(this).find(".client-side-toc-macro").length===0}).each(function(){l(this,D.indexOf(this.nodeName))}).toArray();return m(y,z,[],C)}function j(z,B,A,x,y){z.internalTimer=setTimeout(function(){A.html(t(x,y));delete z.internalTimer;w.trigger("analyticsEvent",{name:"confluence.toc-macro.created",})},500)}s("client-side-toc-macro",{type:s.types.CLASS,attached:function(A){var B=g(A);var z=B.data()||{};var y;if(z.structure==="flat"){y=r(z)}else{y=q(z)}if(z.numberedoutline!==true){B.addClass("hidden-outline")}var C="/rest/api/content/"+a()+"/property/editor";var x;if(d.isConnect()){x=d.request(C)}else{x=g.ajax({url:e.CONTEXT_PATH+C})}x.done(function(D){z.isFabric=D.value==="v2"||D.value==='"v2"';j(A,D,B,y,z)});x.fail(function(D){z.isFabric=false;j(A,D,B,y,z)})},detached:function(x){if(x.internalTimer){clearTimeout(x.internalTimer)}},events:{"click a":function(){w.trigger("analyticsEvent",{name:"confluence.toc-macro.heading-click",})},},})});require("confluence/module-exporter").safeRequire("confluence-toc/js/client-side-toc");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.randombits.confluence.toc:client-side-toc-resources', location = 'net/customware/confluence/plugin/toc/templates/client.soy' */
// This file was automatically generated from client.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Plugins.TableOfContents.Client.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Plugins == 'undefined') { Confluence.Plugins = {}; }
if (typeof Confluence.Plugins.TableOfContents == 'undefined') { Confluence.Plugins.TableOfContents = {}; }
if (typeof Confluence.Plugins.TableOfContents.Client == 'undefined') { Confluence.Plugins.TableOfContents.Client = {}; }


Confluence.Plugins.TableOfContents.Client.tocItemBody = function(opt_data, opt_ignored) {
  return '<span class="toc-item-body" data-outline="' + opt_data.outline + '"><span class="toc-outline">' + opt_data.outline + '</span><a href="' + opt_data.linkHref + '" class="toc-link">' + opt_data.linkText + '</a></span>';
};
if (goog.DEBUG) {
  Confluence.Plugins.TableOfContents.Client.tocItemBody.soyTemplateName = 'Confluence.Plugins.TableOfContents.Client.tocItemBody';
}


Confluence.Plugins.TableOfContents.Client.listStyleTocLevelContainer = function(opt_data, opt_ignored) {
  return '<ul style="' + ((opt_data.cssliststyle) ? ' list-style: ' + soy.$$escapeHtml(opt_data.cssliststyle) + ';' : '') + ((opt_data.csslistindent) ? ' padding-left: ' + soy.$$escapeHtml(opt_data.csslistindent) + ';' : '') + '"></ul>';
};
if (goog.DEBUG) {
  Confluence.Plugins.TableOfContents.Client.listStyleTocLevelContainer.soyTemplateName = 'Confluence.Plugins.TableOfContents.Client.listStyleTocLevelContainer';
}


Confluence.Plugins.TableOfContents.Client.listStyleTocItemContainer = function(opt_data, opt_ignored) {
  return '<li></li>';
};
if (goog.DEBUG) {
  Confluence.Plugins.TableOfContents.Client.listStyleTocItemContainer.soyTemplateName = 'Confluence.Plugins.TableOfContents.Client.listStyleTocItemContainer';
}


Confluence.Plugins.TableOfContents.Client.flatStyleTocItemContainer = function(opt_data, opt_ignored) {
  return '<span class="' + soy.$$escapeHtml(opt_data.cssClass) + '"></span>';
};
if (goog.DEBUG) {
  Confluence.Plugins.TableOfContents.Client.flatStyleTocItemContainer.soyTemplateName = 'Confluence.Plugins.TableOfContents.Client.flatStyleTocItemContainer';
}


Confluence.Plugins.TableOfContents.Client.flatStyleTocSeparator = function(opt_data, opt_ignored) {
  return '<span class="toc-separator">' + soy.$$escapeHtml(opt_data.separator) + '</span>';
};
if (goog.DEBUG) {
  Confluence.Plugins.TableOfContents.Client.flatStyleTocSeparator.soyTemplateName = 'Confluence.Plugins.TableOfContents.Client.flatStyleTocSeparator';
}

}catch(e){WRMCB(e)};