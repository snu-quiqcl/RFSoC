WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:macro-browser-web-resources', location = 'com/atlassian/confluence/extra/calendar3/js/macro-browser.js' */
(function(c){function a(d){if(AJS.MacroBrowser.isInFabricEditor()){AJS.MacroBrowser.setMacroJsOverride(d,{fields:b()})}else{AJS.MacroBrowser.setMacroJsOverride(d,{opener:function(e){if(e.params){tinymce.confluence.macrobrowser.editMacro(tinymce.activeEditor.selection.getNode())}else{Confluence.TeamCalendars.Dialogs.getAddDialogForMacro(e)}},fields:b()})}}function b(){return{string:{id:function(h,e){var d;if(AJS.MacroBrowser.makeParameterDiv){d=AJS.MacroBrowser.makeParameterDiv({},{name:"id",type:"string"})}else{d=AJS.MacroBrowser.ParameterFields.string(h,e).paramDiv}var f=c("<input/>",{"class":"subcalendars-select",type:"hidden"});var i=c("input",d).addClass("hidden").after(f);var g=function(k){if(k){var j=c.isArray(k)?k.join(","):k;i.val(j);if(!i.data("renderedInitialSelection")){i.data("renderedInitialSelection",true);c.ajax({cache:false,data:{subCalendarIds:j},dataType:"json",success:function(l){if(l&&c.isArray(l)){f.auiSelect2("data",c.map(l,function(m){return{id:m.id,text:c("<span/>",{text:m.name}).html()}}))}},timeout:Confluence.TeamCalendars.ajaxTimeout,url:AJS.contextPath()+"/rest/calendar-services/1.0/calendar/util/format/subcalendar/ids.json"})}}else{i.val("")}i.trigger("change")};f.change(function(){g(c.trim(f.auiSelect2("val")))}).auiSelect2({minimumInputLength:1,formatNoMatches:function(j){return c("<div/>").append(c("<span/>",{text:AJS.format("No calendars found with {0}.",j||"")})).html()},formatInputTooShort:function(){return c("<div/>").append(c("<span/>",{text:"Start typing for suggestions"})).html()},multiple:true,query:function(j){c.ajax({cache:false,data:{term:j.term,limit:5,showSubCalendarsInView:"true"},dataType:"json",success:function(k){j.callback({results:(function(){if(k.payload&&k.payload.length){return c.map(k.payload,function(l){return{id:l.subCalendar.id,text:c("<span/>",{text:l.subCalendar.name}).html()}})}return[]})(),more:false});c(".select2-drop-active").addClass("select2-drop")},timeout:Confluence.TeamCalendars.ajaxTimeout,url:AJS.contextPath()+"/rest/calendar-services/1.0/calendar/search/subcalendars.json"})}});c(".select2-container",d).after(c("<div/>",{"class":"id-desc",html:"Start typing for calendar suggestions or \u003cspan class=\"add-subcalendar\"\u003eadd a new calendar\u003c/span\u003e."}).click(function(){AJS.MacroBrowser.close();Confluence.TeamCalendars.Dialogs.getAddDialogForMacro({name:c("#macro-insert-container .macro-name").val(),params:(function(){var j={};c(".macro-param-input").each(function(){var k=c(this);j[k.attr("id").substring(12)]=k.attr("type")==="checkbox"?k.prop("checked"):k.val()});return j})(),defaultParameterValue:""})}));return AJS.MacroBrowser.Field(d,i,c.extend({setValue:function(j){g(j)}}),e)}}}}a("space-calendar");a("team-calendar");a("calendar")})(jQuery);
}catch(e){WRMCB(e)};