"use strict";(self._cf=self._cf||[]).push([[39002],{994009:(e,t,n)=>{n.d(t,{y:()=>s});var i=n(96682);function s(e){const{featureFlags:t}=(0,i.ap)();return t&&t[e]}},526386:(e,t,n)=>{n.d(t,{_C:()=>i,J7:()=>s});const i={iconColor:"inherit",iconGradientStart:"inherit",iconGradientStop:"inherit",label:"",size:"medium",textColor:"currentColor"},s={xsmall:16,small:24,medium:32,large:40,xlarge:48}},491128:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(131436);const s=e=>{let t,n,s,a,o;switch(e){case"brand":t=i.AX,n=i.VY,s=i.VY,a=`var(--ds-text, ${i.q2})`,o=i.AX;break;case"neutral":t=i.mg,n=i.Y8,s=i.Y8,a=i.zN,o=i.zN;break;case"inverse":t=i.uv,n=i.N0,s=i.N0,a=`var(--ds-text-inverse, ${i.N0})`,o=`var(--ds-text-inverse, ${i.N0})`}return{iconGradientStart:t,iconGradientStop:n,iconColor:s,textColor:a,atlassianLogoTextColor:o}}},312535:(e,t,n)=>{n.d(t,{Z:()=>m});var i=n(415911),s=n(953307),a=n(321534),o=n(526386);const r="--logo-color",l="--logo-fill",c=(0,a.iv)({display:"inline-block",position:"relative",color:"var(--logo-color)",fill:"var(--logo-fill)",lineHeight:1,userSelect:"none",whiteSpace:"normal","> svg":{height:"100%",fill:"inherit"}}),d=(0,a.iv)({stop:{stopColor:"currentColor"}}),u=Object.entries(o.J7).reduce(((e,[t,n])=>(e[t]=(0,a.iv)({height:`${n}px`}),e)),{}),m=e=>{let{label:t,svg:n,size:o,appearance:m,iconGradientStart:h,iconGradientStop:p,iconColor:f,textColor:g,testId:E}=e,T=(0,i.Z)(e,["label","svg","size","appearance","iconGradientStart","iconGradientStop","iconColor","textColor","testId"]);const I="inherit"===h&&"inherit"===p&&void 0===m,b=E&&`${E}--wrapper`;return(0,a.tZ)("span",(0,s.Z)({css:[c,I&&d,o&&u[o]],"data-testid":b,style:{[r]:f,[l]:g},"aria-label":t||void 0,role:t?"img":void 0,dangerouslySetInnerHTML:{__html:n}},T))}},615394:(e,t,n)=>{n.d(t,{$:()=>r,Z:()=>l});var i=n(29298),s=n(959029);const a={localization:{eventTypes:{commented:{absolute:"You commented on {absoluteTime}",relative:"You commented {relativeTime}",standalone:"You commented",multiAbsolute:"Commented on {absoluteTime}",multiRelative:"Commented {relativeTime}",multiStandalone:"Commented"},created:{absolute:"You created on {absoluteTime}",relative:"You created {relativeTime}",standalone:"You created",multiAbsolute:"Created on {absoluteTime}",multiRelative:"Created {relativeTime}",multiStandalone:"Created"},edited:{absolute:"You edited on {absoluteTime}",relative:"You edited {relativeTime}",standalone:"You edited",multiAbsolute:"Edited on {absoluteTime}",multiRelative:"Edited {relativeTime}",multiStandalone:"Edited"},published:{absolute:"You published on {absoluteTime}",relative:"You published {relativeTime}",standalone:"You published",multiAbsolute:"Published on {absoluteTime}",multiRelative:"Published {relativeTime}",multiStandalone:"Published"},updated:{absolute:"You updated on {absoluteTime}",relative:"You updated {relativeTime}",standalone:"You updated",multiAbsolute:"Updated on {absoluteTime}",multiRelative:"Updated {relativeTime}",multiStandalone:"Updated"},viewed:{absolute:"You viewed on {absoluteTime}",relative:"You viewed {relativeTime}",standalone:"You viewed",multiAbsolute:"Viewed on {absoluteTime}",multiRelative:"Viewed {relativeTime}",multiStandalone:"Viewed"}}},hydrators:{TownsquareGoal:{hydratorPaths:{id:["id"],key:["key"],name:["name"],url:["url"],icon:["iconData"]}},TownsquareProject:{hydratorPaths:{id:["id"],key:["key"],name:["name"],url:["url"],icon:["iconData"]}},TownsquareComment:{hydratorPaths:{id:["id"],key:["container.key"],name:["container.name"],url:["container.url"],icon:["container.iconData"],deduplicateId:["container.id"]}},ConfluencePage:{hydratorPaths:{id:["id"],name:["title"],localResourceId:["pageId"],url:["links.base","links.webUi"],containers:["space.name"]},staticFallbacks:{icon:"https://fd-assets.prod.atl-paas.net/image/misc-icons/confluence/page.svg"}},ConfluenceBlogPost:{hydratorPaths:{id:["id"],name:["title"],localResourceId:["blogPostId"],url:["links.base","links.webUi"],containers:["space.name"]},staticFallbacks:{icon:"https://fd-assets.prod.atl-paas.net/image/misc-icons/confluence/blogpost.svg"}},ConfluenceComment:{hydratorPaths:{id:["id"],name:["container.title"],url:["links.base","links.webUi"],containers:["container.space.name"],deduplicateId:["container.id"]},staticFallbacks:{icon:"https://fd-assets.prod.atl-paas.net/image/misc-icons/confluence/page.svg",confluenceBlogIcon:"https://fd-assets.prod.atl-paas.net/image/misc-icons/confluence/blogpost.svg",confluencePageIcon:"https://fd-assets.prod.atl-paas.net/image/misc-icons/confluence/page.svg"}},ConfluenceFooterComment:{hydratorPaths:{id:["id"],name:["container.title"],url:["links.base","links.webUi"],containers:["container.space.name"],deduplicateId:["container.id"]},staticFallbacks:{icon:"https://fd-assets.prod.atl-paas.net/image/misc-icons/confluence/page.svg",confluenceBlogIcon:"https://fd-assets.prod.atl-paas.net/image/misc-icons/confluence/blogpost.svg",confluencePageIcon:"https://fd-assets.prod.atl-paas.net/image/misc-icons/confluence/page.svg"}},ConfluenceInlineComment:{hydratorPaths:{id:["id"],name:["container.title"],url:["links.base","links.webUi"],containers:["container.space.name"],deduplicateId:["container.id"]},staticFallbacks:{icon:"https://fd-assets.prod.atl-paas.net/image/misc-icons/confluence/page.svg",confluenceBlogIcon:"https://fd-assets.prod.atl-paas.net/image/misc-icons/confluence/blogpost.svg",confluencePageIcon:"https://fd-assets.prod.atl-paas.net/image/misc-icons/confluence/page.svg"}},JiraIssue:{hydratorPaths:{id:["id"],name:['fieldsById.edges(node.fieldId: "summary").node.text'],url:["webUrl"],containers:['fieldsById.edges(node.fieldId: "project").node.project.name'],icon:['fieldsById.edges(node.fieldId: "issuetype").node.issueType.avatar.xsmall'],key:["key"]}},JiraPlatformComment:{hydratorPaths:{id:["commentId"],name:['issue.fieldsById.edges(node.fieldId: "summary").node.text'],url:["webUrl"],containers:['issue.fieldsById.edges(node.fieldId: "project").node.project.name'],icon:['issue.fieldsById.edges(node.fieldId: "issuetype").node.issueType.avatar.xsmall'],key:["issue.key"],deduplicateId:["issue.id"]}},JiraServiceManagementComment:{hydratorPaths:{id:["commentId"],name:['issue.fieldsById.edges(node.fieldId: "summary").node.text'],url:["webUrl"],containers:['issue.fieldsById.edges(node.fieldId: "project").node.project.name'],icon:['issue.fieldsById.edges(node.fieldId: "issuetype").node.issueType.avatar.xsmall'],key:["issue.key"],deduplicateId:["issue.id"]}}},queryFragments:'\n\n  fragment townsquareGoal on TownsquareGoal {\n    id\n    key\n    name\n    url\n    iconData\n  }\n\n\n  fragment townsquareProject on TownsquareProject {\n    id\n    key\n    name\n    url\n    iconData\n  }\n\n\n  fragment townsquareComment on TownsquareComment {\n    id\n    url\n    container {\n      __typename\n      ...townsquareGoal\n      ...townsquareProject\n    }\n  }\n\n\n  fragment confluencePage on ConfluencePage {\n    id\n    title\n    pageId\n    links {\n      base\n      webUi\n    }\n    space {\n      name\n    }\n  }\n\n\n  fragment confluenceBlogPost on ConfluenceBlogPost {\n    id\n    title\n    blogPostId\n    links {\n      base\n      webUi\n    }\n    space {\n      name\n    }\n  }\n\n\n  fragment confluenceComment on ConfluenceComment {\n    id\n    links {\n      base\n      webUi\n    }\n    container {\n      __typename\n      ...confluenceBlogPost\n      ...confluencePage\n    }\n  }\n\n\n  fragment confluenceFooterComment on ConfluenceFooterComment {\n    id\n    links {\n      base\n      webUi\n    }\n    container {\n      __typename\n      ...confluenceBlogPost\n      ...confluencePage\n    }\n  }\n\n\n  fragment confluenceInlineComment on ConfluenceInlineComment {\n    id\n    links {\n      base\n      webUi\n    }\n    container {\n      __typename\n      ...confluenceBlogPost\n      ...confluencePage\n    }\n  }\n\n\nfragment jiraIssue on JiraIssue {\n  id\n  key\n  webUrl\n  fieldsById(ids: ["summary", "issuetype", "project"]) {\n    edges {\n      node {\n        __typename\n        fieldId\n        ...jiraSingleLineTextField\n        ...jiraIssueTypeField\n        ...jiraProjectField\n      }\n    }\n  }\n}\nfragment jiraSingleLineTextField on JiraSingleLineTextField {\n  text\n}\nfragment jiraIssueTypeField on JiraIssueTypeField {\n  issueType {\n    avatar {\n      xsmall\n    }\n  }\n}\nfragment jiraProjectField on JiraProjectField {\n  project {\n    name\n  }\n}\n\n\nfragment jiraPlatformComment on JiraPlatformComment {\n  commentId\n  webUrl\n  issue {\n    ...jiraIssue\n  }\n}\n\n\nfragment jiraServiceManagementComment on JiraServiceManagementComment {\n  commentId\n  webUrl\n  issue {\n    ...jiraIssue\n  }\n}\n\nfragment activityItemEdge on ActivityItemEdge {\n  cursor\n  node {\n    id\n    object {\n      id\n      type\n      product\n      subProduct\n      rootContainerId\n      contributors {\n        profile {\n          name\n          picture\n          accountId\n        }\n      }\n      data {\n        __typename\n\t...townsquareGoal\n\t...townsquareProject\n\t...townsquareComment\n\t...confluencePage\n\t...confluenceBlogPost\n\t...confluenceComment\n\t...confluenceFooterComment\n\t...confluenceInlineComment\n\t...jiraIssue\n\t...jiraPlatformComment\n\t...jiraServiceManagementComment\n      }\n    }\n    event {\n      id\n      timestamp\n      eventType\n      actor {\n        name\n        picture\n        accountId\n      }\n    }\n  }\n}\nfragment activityItemConnection on ActivityConnection {\n  edges {\n    ...activityItemEdge\n  }\n}\n\n'},o="prod",r={name:"recent-work-service",dimensions:{environmentType:o}};class l{constructor(e,t,n){(0,i.Z)(this,"fetchConfig",(async()=>{const e=await this.fetchArtifact(),{queryFragments:t,hydrators:n}=e;return{fragments:t,hydrators:n}})),this.flightDeck=new s.Z(t||"recent-work-client",{handlers:e},[{name:"recent-work-service",dimensions:{environmentType:o},value:a}]),this.artifactFetch=n}async fetchArtifact(){return this.artifactFetch?this.artifactFetch():this.flightDeck.fetchConfigFromFlightDeck(r,{intervalsMS:[100,500]})}}},784411:(e,t,n)=>{n.d(t,{hl:()=>o});var i=n(721977),s=n(930484);class a{constructor(e,t,n,s="editor-quick-search",a=!1){switch(t){case i.s.ConfluencePageBlog:case i.s.JiraIssue:break;default:throw new Error(`Unsupported scope - ${t}`)}this.scope=t,this.cloudId=e,this.analyticsIdentifier=s,this.useConfluenceTypeInAri=a;const o={cloudId:e,aggregatorUrl:n};this.client=(0,i.e)(o)}getAriString(e){try{return new s.ResourceIdentifier(e).toString()}catch(t){return""}}confluencePageBlogResponseTransformer(e){return e?e.results.map((e=>{var t;return{title:e.title,url:e.baseUrl+e.url,container:e.container.title,contentType:this.mapToContentType(e.content&&e.content.type),updatedTimestamp:e.lastModified,objectId:this.getAriString({resourceOwner:"confluence",cloudId:this.cloudId,resourceType:this.useConfluenceTypeInAri&&(null===(t=e.content)||void 0===t?void 0:t.type)||"content",resourceId:e.content&&e.content.id})}})):[]}jiraIssueResponseTransformer(e){return e?e.results.map((e=>({title:e.name,url:e.url,container:e.attributes.container&&e.attributes.container.title||"",contentType:this.mapToContentType(e.attributes["@type"],e.attributes.issueTypeName),updatedTimestamp:e.attributes.updated,objectId:this.getAriString({resourceOwner:"jira",cloudId:this.cloudId,resourceType:"issue",resourceId:e.id})}))):[]}mapToContentType(e,t){switch(e){case"issue":switch(t){case"Bug":return"jira.issue.bug";case"Story":return"jira.issue.story";case"Task":return"jira.issue.task";default:return"jira.issue"}case"page":return"confluence.page";case"blogpost":return"confluence.blogpost";default:return"default"}}async quickSearch(e,t){const n=await this.client.search({query:e,scopes:[this.scope],analytics:{identifier:this.analyticsIdentifier},resultLimit:t});switch(this.scope){case i.s.ConfluencePageBlog:{const e=n.response.retrieveScope(this.scope);return this.confluencePageBlogResponseTransformer(e)}case i.s.JiraIssue:{const e=n.response.retrieveScope(this.scope);return this.jiraIssueResponseTransformer(e)}default:throw new Error(`Unsupported scope - ${this.scope}`)}}}const o=(e,t,n,i,s)=>new a(e,t,n,i,s)},721977:(e,t,n)=>{n.d(t,{s:()=>h,e:()=>p});var i=n(991332);let s;!function(e){e.ConfluencePageBlogAttachment="confluence.page,blogpost,attachment",e.ConfluencePageBlog="confluence.page,blogpost",e.ConfluenceExperimentsPageBlogAttachment="confluence_experiments.page,blogpost,attachment",e.ConfluenceSpace="confluence.space",e.UserConfluence="urs.user-confluence"}(s||(s={}));let a,o,r;!function(e){e.JiraIssue="jira.issue",e.JiraPlan="jira.plan",e.JiraBoardProjectFilter="jira.board,project,filter",e.JiraBoardProjectFilterPlan="jira.board,project,filter,plan",e.JiraProject="jira.project",e.People="urs.user-jira"}(a||(a={})),function(e){e.JiraIssue="jira-issue",e.JiraBoard="jira-board",e.JiraProject="jira-project",e.JiraFilter="jira-filter",e.JiraPlan="jira-plan",e.JiraPeople="jira-people"}(o||(o={})),function(e){e.issue="issue",e.board="board",e.project="project",e.filter="filter",e.plan="plan",e.people="people"}(r||(r={}));var l=n(29298),c=n(319209);var d=n(26011),u=n.n(d);class m{constructor({url:e,cloudId:t,siteMasterList:n}){(0,l.Z)(this,"getAggregatorConfig",(()=>({url:this.serviceConfig.url,cloudId:this.cloudId,siteMasterList:this.siteMasterList}))),(0,l.Z)(this,"getGenericProductPermissions",(async e=>{return(t=this.makeGetRequest,async(e,n,i)=>{if(0===e.length)return Promise.resolve(new Map);try{const s=e.map((e=>["productId",e])),a=`scopes/v1/${n}?${new URLSearchParams([["experience",i],...s]).toString()}`,o=await t(a);return new Map(Object.keys(o.products).map((e=>[e,o.products[e]])))}catch(s){return new Map}})(e.productIds,this.cloudId,e.experience);var t})),(0,l.Z)(this,"batchedGetExtensibleProductPermission",((e,t,n,s=100)=>{const a={},o=u()((()=>{const s=(0,i.Z)({},a),o=Object.keys(s),r=o.map((e=>s[e].arg));t(e(r)).then((e=>{o.forEach((t=>{s[t].resolve(n(e,t))}))})).catch((()=>{o.forEach((e=>{s[e].reject()}))})).finally((()=>o.forEach((e=>delete a[e]))))}),s);return(e,t)=>{const n=new Promise(((n,i)=>{a[e]={resolve:n,reject:i,arg:t}}));return o(),n}})((e=>{const t={productIds:[],experience:""};return 0===e.length?t:e.reduce(((e,t)=>({productIds:[...e.productIds,...t.productIds],experience:t.experience})),t)}),this.getGenericProductPermissions,((e,t)=>e.get(t)||[]))),(0,l.Z)(this,"makePostRequest",((e,t)=>{const n={path:e,requestInit:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}};return c.utils.requestService(this.serviceConfig,n)})),(0,l.Z)(this,"makeGetRequest",(e=>{const t={path:e,requestInit:{method:"GET",headers:{"Content-Type":"application/json"}}};return c.utils.requestService(this.serviceConfig,t)})),this.serviceConfig={url:e},this.cloudId=t,this.siteMasterList=n}async getAbTestData(e,t,n){const i={cloudId:this.cloudId,scopes:[e],experience:t,product:n},s=(await this.makePostRequest(m.EXPERIMENT_URL_PATH,i)).scopes.find((t=>t.id===e));return s?Promise.resolve(s.abTest):Promise.resolve(null)}async getProductScopes(e,t){return(await this.getGenericProductPermissions({productIds:[e],experience:t})).get(e)||[]}async getProductPermissions(e,t){const n=e.map((e=>e.toLowerCase())),i=await this.getGenericProductPermissions({productIds:n,experience:t});return n.filter((e=>{var t;return null===(t=i.get(e))||void 0===t?void 0:t.length})).map((e=>e.toUpperCase()))}async search({query:e,context:t,scopes:n,modelParams:s,resultLimit:a,filters:o=[],experience:r,sites:l=[]}){const c=this.cloudId,d=l.length>0?l:((e=[])=>e.slice(0,3))(this.siteMasterList).map((e=>e.cloudId)),u=(0,i.Z)((0,i.Z)({query:e,cloudId:c,limit:a,scopes:n,filters:o,searchSession:t},s.length>0?{modelParams:s}:{}),{},{experience:r,cloudIds:d}),{result:h,durationMs:p}=await(async e=>{const t=Date.now();return{result:await e,durationMs:Date.now()-t}})(this.makePostRequest(m.QUICKSEARCH_API_URL,u));return{response:{rawData:h,retrieveScope:e=>h.scopes.find((t=>t.id===e))||null},requestDurationMs:p}}}(0,l.Z)(m,"EXPERIMENT_URL_PATH","experiment/v1"),(0,l.Z)(m,"QUICKSEARCH_API_URL","quicksearch/v1");const h=(0,i.Z)((0,i.Z)({},s),a),p=({cloudId:e,aggregatorUrl:t})=>{const n=new m({cloudId:e,url:t||"/gateway/api/xpsearch-aggregator",siteMasterList:[]});return{search:async function({query:e,scopes:t,resultLimit:i,analytics:s}){return n.search({query:e,context:{sessionId:s.sessionId?s.sessionId:"not-applicable",referrerId:null},scopes:t,modelParams:[],resultLimit:i,filters:[],experience:`external-${s.identifier}`})}}}},558116:(e,t,n)=>{n.d(t,{d:()=>i});const i=()=>"undefined"!=typeof window},776831:(e,t,n)=>{n.d(t,{ur:()=>a,oY:()=>o,o5:()=>r,US:()=>l,sG:()=>c});var i=n(412449),s=n(350635);const a=()=>{if(!globalThis.__UFO_GLOBAL_EVENT_STREAM__){const e=(()=>{const e=[];return{__buffer_only__:!0,push:t=>{e.length<250&&e.push(t)},getStream:()=>e}})();globalThis.__UFO_GLOBAL_EVENT_STREAM__=e}return globalThis.__UFO_GLOBAL_EVENT_STREAM__},o=e=>{var t,n;!globalThis.__UFO_GLOBAL_EVENT_STREAM__||null!==(t=globalThis.__UFO_GLOBAL_EVENT_STREAM__)&&void 0!==t&&t.__buffer_only__?(null!==(n=globalThis.__UFO_GLOBAL_EVENT_STREAM__)&&void 0!==n&&n.__buffer_only__&&globalThis.__UFO_GLOBAL_EVENT_STREAM__.getStream().forEach(e.push.bind(e)),globalThis.__UFO_GLOBAL_EVENT_STREAM__=e):(0,i.hl)("Global Event Stream already initialised. Ignoring new event stream setup")},r=(e,t)=>({type:s.pp.SUBSCRIBE,payload:{experienceId:e,callback:t}}),l=(e,t)=>({type:s.pp.UNSUBSCRIBE,payload:{experienceId:e,callback:t}}),c=e=>({type:s.pp.EXPERIENCE_PAYLOAD,payload:e})},412449:(e,t,n)=>{n.d(t,{b6:()=>a,Hw:()=>o,hl:()=>r});var i=n(29298);class s{constructor(){(0,i.Z)(this,"enabled",!1)}log(...e){this.enabled&&console.log(s.UFOprefix,...e)}warn(...e){this.enabled&&console.warn(s.UFOprefix,...e)}enable(){this.enabled=!0}disable(){this.enabled=!1}}(0,i.Z)(s,"UFOprefix","[ufo🛸]");const a=new s,o=(...e)=>{a.log(...e)},r=(...e)=>{a.warn(...e)}},451203:(e,t,n)=>{n.d(t,{m:()=>a});var i=n(29298),s=n(558116);const a=new class{constructor(){(0,i.Z)(this,"started",!1),(0,i.Z)(this,"observers",[]),(0,i.Z)(this,"broadcast",(()=>{this.observers.forEach((e=>e())),this.observers=[]}))}start(){this.started||(this.started=!0,document.addEventListener("visibilitychange",this.broadcast),(0,s.d)()&&window.addEventListener("pagehide",this.broadcast))}subscribe(e){this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter((t=>t!==e))}}},412920:(e,t,n)=>{n.d(t,{h:()=>i});const i={NOT_STARTED:{id:"NOT_STARTED",final:!0},STARTED:{id:"STARTED"},IN_PROGRESS:{id:"IN_PROGRESS"},BLOCKED:{id:"BLOCKED"},RECOVERED:{id:"RECOVERED"},SUCCEEDED:{id:"SUCCEEDED",final:!0,success:!0},SUCCEEDED_WAITING_FOR_DEPS:{id:"SUCCEEDED_WAITING_FOR_DEPS"},FAILED:{id:"FAILED",final:!0},ABORTED:{id:"ABORTED",final:!0}}},485255:(e,t,n)=>{let i,s;n.d(t,{Z:()=>i,R:()=>s}),function(e){e.Load="load",e.Experience="experience",e.Operation="operation"}(i||(i={})),function(e){e.PageLoad="page-load",e.PageSegmentLoad="page-segment-load",e.InlineResult="inline-result",e.Custom="custom"}(s||(s={}))},486392:(e,t,n)=>{n.d(t,{Q:()=>g});var i=n(991332),s=n(29298),a=n(781095);var o=n(558116),r=n(776831),l=n(412449),c=n(451203),d=n(350635);var u=n(412920);const m={[u.h.NOT_STARTED.id]:[u.h.STARTED.id],[u.h.STARTED.id]:[u.h.IN_PROGRESS.id,u.h.BLOCKED.id,u.h.SUCCEEDED.id,u.h.SUCCEEDED_WAITING_FOR_DEPS.id,u.h.FAILED.id,u.h.ABORTED.id],[u.h.IN_PROGRESS.id]:[u.h.BLOCKED.id,u.h.SUCCEEDED.id,u.h.SUCCEEDED_WAITING_FOR_DEPS.id,u.h.FAILED.id,u.h.ABORTED.id],[u.h.BLOCKED.id]:[u.h.RECOVERED.id,u.h.ABORTED.id],[u.h.RECOVERED.id]:[u.h.STARTED.id,u.h.SUCCEEDED.id,u.h.SUCCEEDED_WAITING_FOR_DEPS.id,u.h.FAILED.id,u.h.ABORTED.id],[u.h.SUCCEEDED.id]:[u.h.STARTED.id],[u.h.SUCCEEDED_WAITING_FOR_DEPS.id]:[u.h.SUCCEEDED.id,u.h.FAILED.id,u.h.ABORTED.id],[u.h.FAILED.id]:[u.h.STARTED.id],[u.h.ABORTED.id]:[u.h.STARTED.id]};var h=n(485255);const p=()=>(0,o.d)()&&window.document&&"visible"!==window.document.visibilityState?d.Qx.HIDDEN:d.Qx.VISIBLE,f=e=>void 0!==e?~~e:~~performance.now();class g extends class{constructor(e,t,n=null){(0,s.Z)(this,"state",u.h.NOT_STARTED),(0,s.Z)(this,"instanceId",null),(0,s.Z)(this,"parent",null),(0,s.Z)(this,"category",null),(0,s.Z)(this,"metadata",{}),(0,s.Z)(this,"onDoneCallbacks",[]),(0,s.Z)(this,"childExperiences",[]),(0,s.Z)(this,"explicitTimings",{}),(0,s.Z)(this,"isSSROutputAsFMP",!1),(0,s.Z)(this,"uuid",null),(0,s.Z)(this,"_until",null),(0,s.Z)(this,"metrics",{startTime:null,endTime:null,marks:[]}),(0,s.Z)(this,"performanceConfig",{}),(0,s.Z)(this,"setPageVisibleStateToMixed",(()=>{this.pageVisibleState=d.Qx.MIXED,c.m.unsubscribe(this.setPageVisibleStateToMixed)})),this.id=e,this.category=(null==t?void 0:t.category)||null,this.until=(null==t?void 0:t.until)||null,this.instanceId=n,this.handleDoneBind=this._handleDoneExperience.bind(this),this.type=t.type,this.performanceType=t.performanceType,this.performanceConfig=t.performanceConfig||{},this.config=t,this.pageVisibleState=p(),this.featureFlags=t.featureFlags||[],this.timings=t.timings||[],t.performanceType!==h.R.PageLoad&&t.performanceType!==h.R.PageSegmentLoad||(this.isSSROutputAsFMP=t.isSSROutputAsFMP||!1)}async transition(e,t){if((0,l.Hw)("async transition",this.id,this.state.id,e.id),n=this.state,i=e,m[n.id]&&m[n.id].includes(i.id)){if((0,l.Hw)(`TRANSITION: ${this.id} from ${this.state.id} to ${e.id} successful`,this.state.final,!e.final),e===u.h.STARTED&&this._reset(),this.state.final&&!e.final&&(this.metrics.startTime=f(t),this.uuid=(0,a.v4)()),this.state=e,e.final){this.metrics.endTime=f(t),this._isManualStateEnabled()||(0,r.ur)().push((0,r.US)(d.lS,this.handleDoneBind));const e=await this.exportData();(0,l.Hw)("this.parent",this.parent),(0,r.ur)().push((0,r.sG)(e))}return!0}var n,i;return(0,l.Hw)(`TRANSITION: ${this.id} from ${this.state.id} to ${e.id} unsuccessful`),(0,l.hl)(`transition of ${this.id} from ${this.state} to ${e} is not possible`),!1}async start(e){await this.transition(u.h.STARTED,e)&&(this.pageVisibleState=p(),c.m.subscribe(this.setPageVisibleStateToMixed),this._isManualStateEnabled()||((0,l.Hw)("subscribed",this.id),(0,r.ur)().push((0,r.o5)(d.lS,this.handleDoneBind))))}mark(e,t){e!==d.WR&&e!==d.j3?this._mark(e,t):(0,l.hl)("please use markFMP or markInlineResponse for specialised marks")}_mark(e,t){this.metrics.marks.push({name:e,time:f(t)}),this.transition(u.h.IN_PROGRESS)}markFMP(e){this._mark(d.WR,e)}markInlineResponse(e){this._mark(d.j3,e)}_isManualStateEnabled(){return null===this.until}_validateManualState(){return!!this._isManualStateEnabled()||((0,l.hl)('manual change of state not allowed as "until" is defined'),!1)}switchToEndState(e,t){return null!=t&&t.force||this._validateManualState()?(null!=t&&t.metadata&&this.addMetadata(t.metadata),c.m.unsubscribe(this.setPageVisibleStateToMixed),this.transition(e)):null}async success(e){return this.switchToEndState(u.h.SUCCEEDED,e)}async failure(e){return this.switchToEndState(u.h.FAILED,e)}async abort(e){return this.switchToEndState(u.h.ABORTED,e)}addMetadata(e){Object.assign(this.metadata,e)}_handleDoneExperience(e){if((0,l.Hw)("_handleDoneExperience in",this.id,e.state,e,this._until),e.state.final&&null!==this._until){const{done:t,state:n}=this._until(e);t&&!this.state.final&&this.transition(n)}}async getId(){return this.id}async exportData(){return{id:await this.getId(),uuid:this.uuid,type:this.type,schemaVersion:"0.1.5",performanceType:this.performanceType,category:this.category,state:this.state,metadata:(0,i.Z)({},this.metadata),metrics:(0,i.Z)({},this.metrics),children:[...this.childExperiences],result:{success:!!this.state.success,startTime:this.metrics.startTime,duration:(this.metrics.endTime||0)-(this.metrics.startTime||0)},platform:this.config.platform||null,pageVisibleState:this.pageVisibleState,featureFlags:this.featureFlags,isSSROutputAsFMP:this.isSSROutputAsFMP,timings:this.timings,explicitTimings:this.explicitTimings,performanceConfig:this.performanceConfig}}_reset(){this.parent=null,this.metadata={},this.onDoneCallbacks=[],this.childExperiences=[],this.metrics={startTime:null,endTime:null,marks:[]},this._until=this.until?this.until():null}}{}},350635:(e,t,n)=>{let i,s,a,o,r,l;n.d(t,{pp:()=>i,Qx:()=>s,lS:()=>c,WR:()=>d,j3:()=>u}),function(e){e[e.EXPERIENCE_PAYLOAD=0]="EXPERIENCE_PAYLOAD",e[e.SUBSCRIBE=1]="SUBSCRIBE",e[e.UNSUBSCRIBE=2]="UNSUBSCRIBE"}(i||(i={})),function(e){e.VISIBLE="visible",e.HIDDEN="hidden",e.MIXED="mixed"}(s||(s={})),function(e){e.fmp="fmp",e.tti="tti"}(a||(a={})),function(e){e.fmp="fmp",e.tti="tti"}(o||(o={})),function(e){e.response="response",e.result="result"}(r||(r={})),function(e){e.duration="duration"}(l||(l={}));const c="__SUBSCRIBE_ALL__",d="fmp",u="inline-response"}}]);
//# sourceMappingURL=39002.MWiWmPYddE.js.map