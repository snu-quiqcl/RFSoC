"use strict";(self._cf=self._cf||[]).push([[19129],{333754:(e,t,n)=>{n.d(t,{K:()=>a,r:()=>r});const a=({isViewPage:e,extensionKey:t,error:n})=>({type:"sendTrackEvent",data:{containerType:"page",objectType:"connectAddon",source:e?"viewPageScreen":"editPageScreen",action:"failed",actionSubject:"connectRefEventDataValidation",attributes:{extensionKey:t,message:n.message}}}),r=({isViewPage:e,extensionKey:t})=>({type:"sendTrackEvent",data:{containerType:"page",objectType:"connectAddon",source:e?"viewPageScreen":"editPageScreen",action:"received",actionSubject:"connectRefEventData",attributes:{extensionKey:t}}})},80634:(e,t,n)=>{n.d(t,{v:()=>m});var a=n(29298);let r;!function(e){e.Success="Success",e.Error="Error"}(r||(r={}));var o=n(347819);let s,c=!1;async function i(){return c||(s=await async function(){const e=(await(0,o.Z)()).filter((e=>null!=e.refDataSchema)).map((e=>[e.macroName,e.refDataSchema.outputType]));return new Map(e)}(),c=!0),s}var l=n(333754);let u;class d{constructor(){(0,a.Z)(this,"emit",void 0)}init({emit:e}){this.emit=e}static async validate(e,t){const{validateSchema:a,DataTransferValidationError:r}=await Promise.all([n.e(11216),n.e(14050)]).then(n.bind(n,366920));if(!t.eventData)throw new r({message:"Passed data is missing 'eventData'."});const o=Object.keys(t.eventData);if(1!==o.length)throw new r({message:"'eventData' should only include a single key. The key should be same with 'refDataSchema.outputType'."});const s=await i();if(!s.has(e))throw new Error("extensionKey is not found in the macro metadata.");if(s.get(e)!==o[0])throw new r({message:`'eventData' should contain 'refDataSchema.outputType' defined in the app manifest (${s.get(e)}).`});a(o[0],t.eventData[o[0]])}async transfer(e,t,a,o,s){if(this.emit&&t&&a){const{DataTransferValidationError:i}=await Promise.all([n.e(11216),n.e(14050)]).then(n.bind(n,366920));try{await d.validate(e,a)}catch(c){if(o((0,l.K)({isViewPage:s,extensionKey:e,error:c})).fire(),c instanceof i)return{status:r.Error,message:c.message,module:"data_provider",errors:c.errors};throw c}return this.emit(t,a.eventData),{status:r.Success,message:"Data accepted and emitted",module:"data_provider"}}return{status:r.Error,message:"There was an issue accepting the data",module:"data_provider"}}}const m=()=>(u||(u=new d),u)},647273:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(991332),r=n(790632),o=n(122551),s=n(844151),c=n(93375);const i=(0,o.memo)((({contentId:e,className:t,isInline:n,nodeProps:r,macroDataProps:s,macroRepresentation:i,macroRenderedOutput:l,style:u,children:d,featureFlags:m,extensionHandlers:p,mediaToken:f})=>{const v=n?"span":"div";return d?o.createElement(v,(0,a.Z)((0,a.Z)({className:t,style:u},r),s),d):"atlas_doc_format"===i?l?o.createElement(v,(0,a.Z)((0,a.Z)((0,a.Z)({className:t,style:u},r),s),{},{"data-testid":"legacy-macro-adf"}),o.createElement(c.J,{document:JSON.parse(l),contentId:e,featureFlags:null!=m?m:{},extensionHandlers:p,mediaToken:f})):null:o.createElement(v,(0,a.Z)((0,a.Z)((0,a.Z)({className:t,style:u,dangerouslySetInnerHTML:{__html:`${l}`}},r),s),{},{"data-testid":"legacy-macro-element"}))})),l=e=>{var t,n,a;const r=(null==e||null===(t=e.attrs)||void 0===t||null===(n=t.parameters)||void 0===n?void 0:n.macroParams)||{},o=(null==e||null===(a=e.attrs)||void 0===a?void 0:a.extensionKey)||"";let s=`macro${o}`;return"jira"!==o||r.key||r.count||(s+="Table"),s},u=(0,r.Z)(i,{target:"e1ihjts80"})('white-space:normal;p{white-space:normal;}[data-node-type="expand"]{margin-left:0px;margin-right:0px;}',(e=>("macrojiraTable"===l(e.adf)||"macroinclude"===l(e.adf))&&".ak-renderer-document > div.ak-renderer-extension {\n      width: 100% !important;\n    }")," ",(e=>"macroinclude"===l(e.adf)&&".ak-renderer-document .ak-renderer-extension-overflow-container .error {\n        padding: 5px;\n      }")," ",(e=>"macrojiraTable"===l(e.adf)&&"display: block;\n        max-width: 100%;\n        overflow-x: auto;\n        th {\n          word-break: normal;\n        }")," ",(e=>e.mode===s.Uw&&"position: relative; user-select: none;")," ",(e=>e.isInline?"clear: none;":"clear: both;")," ",(e=>e.mode===s._B&&e.isInline&&"display: inline-block; padding: 2px;")," ",(e=>"macroinclude"===l(e.adf)&&'.ak-renderer-document > .pm-table-container > .pm-table-wrapper {\n        padding: 0;\n        margin: 0;\n      }\n      .ak-renderer-document [data-testid="sticky-table-fixed"] > .pm-table-container {\n        margin-bottom: 0;\n      }\n      .ak-renderer-document [data-testid="sticky-table-fixed"] > .pm-table-container table {\n        margin-top: 0;\n      }')," table.confluenceTable{tr{th.confluenceTh:nth-child(1),td.confluenceTd:nth-child(1){padding-left:10px;}}}")},471017:(e,t,n)=>{n.d(t,{w:()=>a});const a=n(122551).createContext({})},746539:(e,t,n)=>{n.d(t,{U:()=>f});var a=n(991332),r=n(122551),o=n(325834),s=n(172328),c=n(668410),i=n(758724),l=n(158466),u=n(647273),d=n(89557),m=n(835989);const p=({node:e,mode:t,contentId:n,featureFlags:a})=>{const{contentId:o}=(0,r.useContext)(d.z1);(0,c.MK)(e),Boolean(a["confluence.frontend.fabric.editor.macro.adf.frontend.render"]),Boolean(a["confluence.frontend.throttle.legacy.macro.query"]);return r.createElement(m.n,{node:e})};p.displayName="FabricLegacyMacrosServerLoader";const f=({macroRenderedOutput:e,macroDefaultProps:t,containerRef:n,macroOutput:d})=>{var m,f,v,y,g,b,h,w,x,E,k,I,_,Z,A,O,S,P;const{featureFlags:$}=(0,l.D)(),C=Boolean($["confluence.frontend.use.macro.output"])?d:null,{createAnalyticsEvent:M}=(0,o._)(),{node:T,contentId:D,mode:R,extensionKey:N}=t,L=null===(m=T.parameters)||void 0===m||null===(f=m.macroMetadata)||void 0===f||null===(v=f.macroId)||void 0===v?void 0:v.value,K=null===(y=T.parameters)||void 0===y||null===(g=y.macroParams)||void 0===g||null===(b=g.isMissingRequiredParameters)||void 0===b?void 0:b.value;if((0,r.useEffect)((()=>{C&&M({type:"sendTrackEvent",data:{action:"viewed",actionSubject:"macro.with.macroOutput",source:"FabricLegacyMacrosServerRenderer",attributes:{extensionKey:N,contentId:D}}}).fire()}),[C,M,N,D]),!C&&K)return null;const j=e?e.filter((e=>(null==e?void 0:e.key)===L)):[];if(!C&&0===j.length)return r.createElement(p,(0,a.Z)((0,a.Z)({},t),{},{featureFlags:$}));const U=(null===(h=j[0])||void 0===h||null===(w=h.value)||void 0===w?void 0:w.value)||C;if(!U)return null;const V=null===(x=j[0])||void 0===x||null===(E=x.value)||void 0===E||null===(k=E.webresource)||void 0===k||null===(I=k.tags)||void 0===I?void 0:I.css,F=null===(_=j[0])||void 0===_||null===(Z=_.value)||void 0===Z||null===(A=Z.webresource)||void 0===A||null===(O=A.tags)||void 0===O?void 0:O.js,J=(0,c.MK)(t.node),G=J.type===s.gU,H={"data-fabric-macro":L,"data-macro-body":U||"","data-macro-parameters":(0,c.Z6)(T)},q={ref:n||null},B=(null===(S=j[0])||void 0===S||null===(P=S.value)||void 0===P?void 0:P.representation)||"view",W={adf:J,isInline:G,contentId:D,mode:R,extensionKey:N,macroRepresentation:B,macroDataProps:H,macroRenderedOutput:U,featureFlags:$,nodeProps:q};return r.createElement(r.Fragment,null,V&&r.createElement("div",{key:"css-container","data-testid":"macro_css",dangerouslySetInnerHTML:{__html:`${V}`},style:{display:"none"}}),r.createElement(u.Z,(0,a.Z)({},W)),F&&r.createElement("div",{"data-testid":"macro_js",dangerouslySetInnerHTML:{__html:`${(0,i.ac)(F)}`},style:{display:"none"}}))};f.displayName="FabricLegacyMacrosServerRenderer"},835989:(e,t,n)=>{n.d(t,{n:()=>m});var a=n(991332),r=n(415911),o=n(122551),s=n(962285),c=n(358280),i=n(612642),l=n(131436);n(40592),n(778683),n(520700),n(114486),n(963315),n(334414),n(555698),n(517529),n(878660),n(2155),n(234369),n(494834),n(563952);const u=(0,o.forwardRef)(((e,t)=>{let{as:n="span",style:u}=e,d=(0,r.Z)(e,["as","style"]);return o.createElement(n,(0,a.Z)((0,a.Z)({},d),{},{style:(0,a.Z)((0,a.Z)({},u),{},{"--_1ur7qvb":(0,s.Z)((0,i.Z)("color.skeleton",l.IR))}),ref:t,className:(0,c.Z)(["_1e0c1o8l _bfhk18gw _2rko14y2 _1ul912am _4t3i10yn _ca0q14y2 _u5f314y2 _n3td14y2 _19bv14y2",d.className])}))}));const d=(0,o.forwardRef)(((e,t)=>{let{as:n="div",style:u}=e,d=(0,r.Z)(e,["as","style"]);return o.createElement(n,(0,a.Z)((0,a.Z)({},d),{},{style:(0,a.Z)((0,a.Z)({},u),{},{"--_1ur7qvb":(0,s.Z)((0,i.Z)("color.skeleton",l.IR))}),ref:t,className:(0,c.Z)(["_1e0c1ule _bfhk18gw _2rko14y2 _1bsb1osq _1ul91wqb _4t3i10yn _ca0q14y2 _u5f314y2 _n3td14y2 _19bv14y2 _vchhusvi",d.className])}))}));const m=({node:e})=>e&&"inlineExtension"===e.type?o.createElement(u,{"data-testid":"ext-skeleton"}):o.createElement(d,{"data-testid":"ext-skeleton"})},689110:(e,t,n)=>{n.d(t,{u:()=>i,k:()=>l});var a=n(336198),r=n(464984),o=n(612642),s=n(131436);const c=(0,r.defineMessages)({contentRendererInlineCommentMarkerStart:{id:"content-renderer.inlineComment.marker.start",defaultMessage:"inline comment start"},contentRendererInlineCommentMarkerEnd:{id:"content-renderer.inlineComment.marker.end",defaultMessage:"inline comment end"}}),i=(e,t,n)=>l(n),l=e=>(0,a.iv)('div[mode="stick"]{z-index:1;background:',(0,o.Z)("color.background.inverse.subtle",s.N0),";}span{&.inline-highlight{",(e=>(0,a.iv)("cursor:pointer;background-color:",(0,o.Z)("color.background.accent.yellow.subtler",s.a8),";border-bottom:2px solid ",(0,o.Z)("color.border","rgba(255, 196, 0, 0.82)"),";&.active-highlight{background-color:",(0,o.Z)("color.background.accent.yellow.subtle",s.ii),";border-bottom:2px solid ",(0,o.Z)("color.border.accent.yellow",s.Z3),";box-shadow:",(0,o.Z)("elevation.shadow.overlay",`0 2px 2px ${s.uv}`),';}&::before,&::after{clip-path:inset(100%);clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;}&::before,.first-mark-highlight{content:" [',e.formatMessage(c.contentRendererInlineCommentMarkerStart),'] ";}&::after,.last-mark-highlight{content:" [',e.formatMessage(c.contentRendererInlineCommentMarkerEnd),'] ";}'))(e),"}&.inline-create-comment-selection{background-color:",(0,o.Z)("color.background.accent.yellow.subtle",s.ii),";border-bottom:2px solid ",(0,o.Z)("color.border.accent.yellow",s.Z3),";box-shadow:",(0,o.Z)("elevation.shadow.overlay",`0 2px 2px ${s.uv}`),";}}")},172328:(e,t,n)=>{n.d(t,{UE:()=>a,_N:()=>r,OR:()=>o,gU:()=>s,x9:()=>c,D4:()=>i,rI:()=>l,KJ:()=>u,c0:()=>d});const a={TEMPLATE:"com.atlassian.confluence.template",MACRO_CORE:"com.atlassian.confluence.macro.core",MIGRATION:"com.atlassian.confluence.migration",MACRO_WITH_REFERENCES:"com.atlassian.confluence.macro.with.references"},r={INVALID:"__confluenceADFMigrationUnsupportedContentInternalExtension__"},o="extension",s="inlineExtension",c="bodiedExtension",i=[{content:[],type:"paragraph"}],l={TEMPLATE:"variable",INLINE_EXTERNAL_IMAGE:"inline-external-image",INLINE_MEDIA_IMAGE:"inline-media-image",PRIVACY_MARK:"privacy-mark",ANCHOR:"anchor",PANEL:"panel",SECTION:"section",CHEESE:"cheese",COLUMN:"column",CONTENT_BY_USER:"content-by-user",CREATE_SPACE_BUTTON:"create-space-button",FAVORITE_PAGES:"favpages",GLOBAL_REPORTS:"global-reports",IM_PRESENCE:"im",LOREMIPSUM:"loremipsum",NAVIGATION_MAP:"navmap",RECENTLY_USED_LABELS:"recently-used-labels",SEARCH:"search",SPACE_DETAILS:"space-details",INVALID:"__confluenceADFMigrationUnsupportedContentInternalExtension__",REDACTED_MACRO_PLACEHOLDER:"redactedMacroPlaceholder"},u=["toc","expand","jira","trello-board","status","jiraroadmap"],d=255},123474:(e,t,n)=>{n.d(t,{uS:()=>o,KD:()=>s});var a=n(917068);const r={align:!0,bgcolor:!0,center:!0,cheese:!0,clickable:!0,code:!0,colgroup:!0,column:!0,"content-by-user":!0,copyright:!0,"create-space-button":!0,div:!0,"fancy-bullets":!0,"google-drive-docs":!0,"google-drive-sheets":!0,"google-drive-slides":!0,favpages:!0,"gadget-b7a6531b1c147f2e175f1209bed5c0ad":!0,"gadget-01c2ed272e88f7333da124a03a481477":!0,"global-reports":!0,highlight:!0,htmlcomment:!0,im:!0,img:!0,info:!0,junitreport:!0,li:!0,loremipsum:!0,lozenge:!0,multimedia:!0,navmap:!0,network:!0,noformat:!0,note:!0,ol:!0,OneDrive:!0,p:!0,panel:!0,pre:!0,"privacy-policy":!0,"privacy-mark":!0,"recently-used-labels":!0,"reg-tm":!0,rollover:!0,roundrect:!0,search:!0,section:!0,sm:!0,"space-attachments":!0,"space-details":!0,span:!0,status:!0,strike:!0,style:!0,table:!0,tbody:!0,td:!0,th:!0,thead:!0,tr:!0,tip:!0,tm:!0,ul:!0,warning:!0};function o(e){const t=e.getBooleanValue("confluence.frontend.prevent.slash.command.trello.macros",{default:!1})?{"trello-board":!0,"trello-card":!0}:{};return e=>!function(e,t={}){const n=e.alternateId||(e.id?e.id.replace("macro-",""):e.macroName);return t.hasOwnProperty(n)?t[n]:Boolean(r[n])}(e,t)}async function s(e){const t=[...e.metadataList],{featureFlagClient:n}=await(0,a.g)(),r=o(n);return e.metadataList=e.metadataList.filter(r),function(){e.metadataList=t}}},208757:(e,t,n)=>{n.d(t,{T:()=>u});var a=n(991332),r=n(331377),o=n(315677),s=n(172328),c=n(668410);const i=e=>!/^[0-9]+$/.test(e),l=r.ZP`query MacroPlaceholderADFQuery($contentId:ID!$macroDefinition:String!)@experimental{experimentalMacroPlaceholderADF(contentId:$contentId macroDefinition:$macroDefinition){json}}`,u=async e=>{const{macroDefinition:t,contentId:n,selectedMacro:r}=e,u=await(0,o.WQ)().query({query:l,variables:{contentId:i(n)?"0":n,macroDefinition:JSON.stringify(t)}});let d;try{var m,p;d=JSON.parse(null==u||null===(m=u.data)||void 0===m||null===(p=m.experimentalMacroPlaceholderADF)||void 0===p?void 0:p.json)}catch(v){console.error("Error getting placeholder ADF")}const f=(0,a.Z)({},d);return f.type===s.x9&&(r?f.content=r.content:f.content&&0!==f.content.length||(f.content=s.D4)),(0,c.g$)(f)}},347819:(e,t,n)=>{n.d(t,{J:()=>v,Z:()=>y});var a=n(917068),r=n(653373),o=n(123474),s=n(724421),c=n.n(s),i=n(208757),l=n(668410);async function u(e){const t={macroDefinition:{name:"jira"},contentId:e},n=await(0,i.T)(t);return e=>function(e,t){const n={source:e},a=c().require("confluence/jim/editor-plugins/jira-paste-link").pasteHandler(n,null,(()=>{}));if(!a||!a.params)return null;const r=JSON.parse(JSON.stringify(t));return r.attrs.parameters||(r.attrs.parameters={}),r.attrs.parameters.macroParams=(0,l.ZI)(a.params),r}(e,n)}const d=e=>{for(;-1!==e.indexOf("{}{}");)e=e.replace("{}{}","{}");return e="^"+(e=((e,t,n)=>n.replace(new RegExp(e,"g"),t))("{}","[^/]*?",e=e.replace(/[\-\[\]\/\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")))+"$"};async function m(e,t){const n=[],r=await e(),o=new Set,{featureFlagClient:s}=await(0,a.g)(),c=s.getBooleanValue("confluence.frontend.prevent.trello.links.automatically.converting.to.trello.macro",{default:!1});r.forEach((e=>{!(e=>e.autoconvertData&&e.autoconvertData.urlParameter&&e.autoconvertData.patterns)(e)||"trello-card"===e.macroName&&c||e.autoconvertData.patterns.forEach((t=>{if((e=>["http://","https://","http://{}","https://{}","http://{}.{}","https://{}.{}","http://{}.{}.{}","https://{}.{}.{}"].every((t=>t!==e)))(t)){const a={macroName:e.macroName,urlParameter:e.autoconvertData.urlParameter,matcher:d(t)};o.add(a.macroName),n.push(a)}}))}));const u=await(async(e,t)=>(await Promise.all(Array.from(e).map((e=>(0,i.T)({macroDefinition:{name:e},contentId:t}))))).reduce(((e,t)=>(e[t.attrs.extensionKey]=t,e)),{}))(o,t);return e=>((e,t,n)=>{const a=t.find((t=>!!e.match(t.matcher)));if(a){const{macroName:t,urlParameter:r}=a,o={};o[r]=e;const s=n[t],c=JSON.parse(JSON.stringify(s));return c.attrs.text=`${r} = ${e}`,c.attrs.extensionKey=t,c.attrs.parameters||(c.attrs.parameters={}),c.attrs.parameters.macroParams=(0,l.ZI)(o),c}return null})(e,n,u)}const p=()=>null,f=(0,r.kg)();function v(e){return(async(e,t)=>{const{contentId:n}=t;if(!n)return p;const[a,r]=await Promise.all([u(n),m(e,n)]);return e=>a(e)||r(e)})(y,e)}const y=async()=>{const[e]=await Promise.all([f(),(0,a.g)()]),{featureFlagClient:t}=await(0,a.g)(),n=(0,o.uS)(t);return e.filter((e=>!e.hidden&&n(e)))}},668410:(e,t,n)=>{n.d(t,{Mj:()=>f,MK:()=>m,XF:()=>v,g$:()=>p,I:()=>i,Z6:()=>y,LW:()=>l,ZI:()=>u});var a=n(991332),r=n(415911),o=n(315677),s=n(172328);const c=n(331377).ZP`query ContentBodyConvertQuery($from:String!$to:String!$body:String!$contentIdContext:String)@experimental{experimentalContentBodyConvert(body:$body from:$from to:$to contentIdContext:$contentIdContext){value}}`;function i(e){return e.hasOwnProperty("")&&d(e[""])||""}function l(e={}){return Object.keys(e).reduce(((t,n)=>{const a=d(e[n]);return""!==a&&(t[n]=a),t}),{})}function u(e={}){return Object.keys(e).reduce(((t,n)=>{const a=d(e[n]);return""===n&&""===a||(t[n]={value:a}),t}),{})}function d(e){return null!=e&&e.hasOwnProperty("value")?e.value:e}function m(e){const{type:t,content:n}=e,a=(0,r.Z)(e,["type","content"]),{macroParams:o}=a.parameters,s={type:t,attrs:a};return s.attrs.bodyType="none","bodiedExtension"===t&&(s.content=n&&n.length>0?n:[],s.attrs.bodyType="rich"),s.attrs.parameters.macroParams=u(o),s}function p(e){const{attrs:t,content:n,type:a}=e,{macroParams:r}=t.parameters;let o=s.OR;a===s.x9?o=s.x9:a===s.gU&&(o=s.gU);const c={type:o,attrs:t};return c.attrs.parameters||(c.attrs.parameters={}),n&&(c.content=n),c.attrs.parameters.macroParams=u(r),c}async function f(e,t,n,a){var r;return null===(r=(await(0,o.WQ)().query({query:c,variables:{from:e,to:t,body:n,contentIdContext:a}})).data.experimentalContentBodyConvert)||void 0===r?void 0:r.value}async function v(e){if(e.hasOwnProperty("name")&&!e.hasOwnProperty("attrs"))return Promise.resolve(e);const t=e,{attrs:n}=t,{extensionKey:a,parameters:r}=n||{extensionKey:null,parameters:{macroParams:{},macroMetadata:{schemaVersion:null}}},{macroParams:o,macroMetadata:s}=r,c=a||"",u=l(o||{}),d=i(o||{}),m=s&&s.schemaVersion||"1";if(!t.content||0===t.content.length)return{name:c,params:u,defaultParameterValue:d,schemaVersion:m,body:""};return{name:c,params:u,defaultParameterValue:d,schemaVersion:m,body:await f("atlas_doc_format","storage",JSON.stringify({type:"doc",content:t.content,version:1}))||""}}function y(e){var t;const n=(0,a.Z)({},(null==e||null===(t=e.parameters)||void 0===t?void 0:t.macroParams)||{});return n.__bodyContent&&delete n.__bodyContent,JSON.stringify(l(n))}},653373:(e,t,n)=>{n.d(t,{CT:()=>i,bS:()=>l,kg:()=>u});var a=n(275758),r=n(188358),o=n(207976),s=n(251846);const c=["wr!confluence.web.resources:view-content","wr!confluence.macros.advanced:get-more"],i=()=>["wrc!com.atlassian.confluence.extra.team-calendars:amd","wrc!com.atlassian.confluence.extra.team-calendars:user-timezone-setup","wrc!com.atlassian.confluence.extra.team-calendars:calendar-init-editor","wrc!com.atlassian.confluence.extra.team-calendars:macro-browser-web-resources"];function l(e,t,n,o,s,i){let l,u=[];if(t||n)u=[...c];else{var d,m;if(!e)return Promise.resolve();l=null!==(d=null==e||null===(m=e.tags)||void 0===m?void 0:m.js)&&void 0!==d?d:null;const t=l&&s?[]:e.contexts&&e.contexts.map((e=>`wrc!${e}`))||[],n=l&&s?[]:e.keys&&e.keys.map((e=>`wr!${e}`))||[];u=[...c,...t,...n]}return new Promise((e=>{(0,a.N)(u,(()=>{o&&o(),s&&l?(0,r.K)(s,l).then(e):e()}),(()=>{console.error(`Cannot loadMacroWebResources: ${u}`),i&&i()}))}))}function u(){let e=null;return function(){if(e)return Promise.resolve(e);const t=e=>e.json();return(0,o.y)("/wiki/plugins/macrobrowser/browse-macros.action?detailed=false&t=12").then(t,(e=>{if(e instanceof s.K)return t(e.response);throw e})).then((({macros:t})=>(e=t,t)))}}},844151:(e,t,n)=>{n.d(t,{_B:()=>f,Uw:()=>v,Sx:()=>y,iQ:()=>k,e7:()=>_,U7:()=>Z,uD:()=>T,SY:()=>D,ag:()=>R});var a=n(415911),r=n(991332),o=n(69210),s=n(199319),c=n(944997),i=n(275513),l=n(534322),u=n(380724),d=n(443033),m=n(574409),p=n(140966);const f="renderer",v="editor",y="confluence.frontend.macro.analytics.tracker",g="taskSuccess",b="taskFail",h="taskAbort",w="taskStart",x=e=>e.split(".").slice(1).join("."),E=(e=new Map)=>{const t=[];for(const n of e.values()){const{name:e}=n;if(e!==s.Gvd){const a=(0,r.Z)({uniqueHash:x(e)},I(n));t.push(a)}}return t},k=e=>{var t,n,a;return{type:(null!=(a=e)?a.type:a)||"",macroId:(0,p.or)(null!=(n=e)?n.parameters:n),extensionKey:(0,p.U)(e),extensionType:(null!=(t=e)?t.extensionType:t)||""}},I=e=>{var t,n,a,r,o,s,c;return{extensionKey:(0,p.U)(null!=(c=e)?c.experienceAttributes:c),extensionType:(null!=(s=e)&&null!=(s=s.experienceAttributes)?s.extensionType:s)||"",type:(null!=(o=e)&&null!=(o=o.experienceAttributes)?o.type:o)||"",macroId:(null!=(r=e)&&null!=(r=r.experienceAttributes)?r.macroId:r)||"",duration:(null!=(a=e)?a.duration:a)||"",status:(null!=(n=e)?n.status:n)||"",pageId:(null!=(t=e)?t.pageId:t)||""}},_=(e,t)=>{M(e,t).has(t)||D(e,t).start({attributes:{mode:e},name:s.Gvd,timeout:c.O.MACRO_LOAD,id:t})},Z=(e,t)=>{const n=M(e,t);if(n.has(t)){if(A(n)){const t={mode:e,macros:null};O(n)&&(t.macros=E(n)),(0,i.OV)().succeed({name:s.Gvd,attributes:(0,r.Z)({},t)})}else(0,i.OV)().abort({name:s.Gvd,reason:`Some macro aborted before completion in ${c.O.MACRO_LOAD}ms`,attributes:{macros:E(n),mode:e}});P(n).forEach((t=>{const n=(0,p.U)(t.experienceAttributes),a=t.status;(0,d.getAnalyticsWebClient)().then((o=>{o.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:a,attributes:(0,r.Z)((0,r.Z)({},t.experienceAttributes),{},{extensionKey:n,mode:e,task:`${s.HJi}`})})}))})),n.clear(),C.set(`${e}.${t}`,n)}},A=(e=new Map)=>{if(0===e.size)return!0;for(const t of e.values())if(t.name!==s.Gvd&&t.status!==g)return!1;return!0},O=(e=new Map)=>{for(const t of e.values())if(t.name!==s.Gvd)return!0;return!1},S=e=>e.includes(p.o$),P=e=>{const t=[];for(const n of e.values())S(n.name)&&t.push(n);return t},$=(e,t)=>{!function n(){setTimeout((()=>{const a=M(t,e);if(!a.has(e))return;const o=a.get(e),l=Math.round(window.performance.now()-o.startTime)>c.O.MACRO_LOAD;if(A(a)&&O(a))(0,i.OV)().succeed({name:s.Gvd,attributes:{macros:E(a),mode:t}});else if(l){if(O(a)){(0,i.OV)().abort({name:s.Gvd,reason:`Some macro aborted before completion in ${c.O.MACRO_LOAD}ms`,attributes:{macros:E(a),mode:t}});(e=>{const t=[];for(const n of e.values())S(n.name)&&n.status!==g&&t.push(n);return t})(a).forEach((e=>{const n=(0,p.U)(e.experienceAttributes);(0,d.getAnalyticsWebClient)().then((a=>{a.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:"taskAbort",attributes:(0,r.Z)((0,r.Z)({},e.experienceAttributes),{},{extensionKey:n,mode:t,task:`${s.HJi}`,reason:`JIRA macro aborted before completion in ${c.O.MACRO_LOAD}ms`})})}))}))}else(0,i.OV)().succeed({name:s.Gvd,attributes:{mode:t}});a.clear(),C.set(`${t}.${e}`,a)}else n()}),2e3)}()},C=new Map,M=(e,t)=>(C.has(`${e}.${t}`)||C.set(`${e}.${t}`,new Map),C.get(`${e}.${t}`)),T=(e,t,n,a)=>{var o;const i=M(e,t),u=null!=(o=a)?o.macroId:o;if(i.has(u)&&S(n)){const t=(0,p.U)(a),{status:n}=i.get(u);if(n===g){const{duration:n}=i.get(u);(0,d.getAnalyticsWebClient)().then((o=>{o.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:"taskSuccess",attributes:(0,r.Z)((0,r.Z)({},a),{},{extensionKey:t,mode:e,duration:n,task:`${s.HJi}`,pageLoadInfo:(0,m.aX)()})})}))}else if(n===h){const{duration:n}=i.get(u);(0,d.getAnalyticsWebClient)().then((o=>{o.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:"taskAbort",attributes:(0,r.Z)((0,r.Z)({},a),{},{extensionKey:t,mode:e,duration:n,task:`${s.HJi}`,reason:`JIRA macro aborted before completion in ${c.O.MACRO_LOAD}ms`})})}))}else if(n===b){const{duration:n}=i.get(u);(0,d.getAnalyticsWebClient)().then((o=>{o.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:"taskFail",attributes:(0,r.Z)((0,r.Z)({},a),{},{extensionKey:t,mode:e,duration:n,task:`${s.HJi}`,error:new l.t(`JIRA macro failed to complete in ${c.O.MACRO_LOAD}ms`)})})}))}}},D=(0,o.default)(((e,t)=>{const n=new u.D,o=M(e,t);return n.subscribe((n=>{var l;const{action:u,name:f,attributes:v}=n,y=(0,a.Z)(n,["action","name","attributes"]),x=null!=(l=v)?l.macroId:l;if(u===w){const n=o.get(x);if(n&&n.id===x)return;f===s.Gvd?o.has(t)||(o.clear(),(0,i.OV)().start({name:s.Gvd,timeout:c.O.MACRO_LOAD,id:t,attributes:{mode:e}}),o.set(t,(0,r.Z)({status:w,name:f,mode:e},y)),C.set(`${e}.${t}`,o)):(o.set(x,(0,r.Z)({status:w,name:f,experienceAttributes:(0,r.Z)((0,r.Z)({},v),{},{extensionKey:(0,p.U)(v)}),pageId:t,mode:e},y)),((e,t,n,a)=>{if(S(n)){const n=(0,p.U)(a);(0,d.getAnalyticsWebClient)().then((o=>{o.sendOperationalEvent({source:"ui",actionSubject:"macroTracker",action:"taskStart",attributes:(0,r.Z)((0,r.Z)({},a),{},{extensionKey:n,mode:e,pageId:t,task:`${s.HJi}`,pageLoadInfo:(0,m.aX)()})})}))}})(e,t,f,v))}else if(u===g){if(!o.has(x))return;const{duration:a,name:s}=n;o.set(x,(0,r.Z)((0,r.Z)({},o.get(x)),{},{id:x,name:s,mode:e,status:g,duration:a,pageId:t})),C.set(`${e}.${t}`,o),T(e,t,s,v)}else if(u===h){if(!o.has(x))return;const{duration:a,reason:c,name:l}=n;o.set(x,(0,r.Z)((0,r.Z)({},o.get(x)),{},{id:x,name:l,mode:e,status:h,duration:a,pageId:t,reason:c})),C.set(`${e}.${t}`,o),(0,i.OV)().abort({name:s.Gvd,reason:"Macro abort loading",attributes:{macros:E(o),mode:e}}),T(e,t,l,v)}else if(u==b){if(!o.has(x))return;const{duration:a,error:c,name:l}=n;o.set(x,(0,r.Z)((0,r.Z)({},o.get(x)),{},{id:x,name:l,mode:e,status:b,duration:a,pageId:t,error:c})),C.set(`${e}.${t}`,o),(0,i.OV)().fail({name:s.Gvd,error:c,attributes:{macros:E(o),mode:e}}),T(e,t,l,v)}$(t,e)})),n})),R=(e,t)=>{const n=k(t);return`${e}.${(0,p.U)(n)}.${n.macroId}`}},690359:(e,t,n)=>{n.d(t,{N:()=>s});var a=n(483565),r=n(844151),o=n(897599);function s({attributes:e,children:t=null,contentId:n,extensionKey:s,mode:c,name:i}){const l=(0,a.TW)(r.Sx);return(0,o.K)((()=>{l&&(0,r.SY)(c,n).succeed({name:i,attributes:e})}),[e,n,s,l,c,i]),t}},140966:(e,t,n)=>{n.d(t,{o$:()=>s,or:()=>c,U:()=>i});var a=n(197728),r=n.n(a),o=n(368807);const s="jira",c=e=>{var t;if(!e)return r()();const n=null!=(t=e)&&null!=(t=t.macroMetadata)&&null!=(t=t.macroId)?t.value:t;return n||(0,o.S)(e)},i=e=>{var t;if(!e)return"";const{extensionKey:n}=e,a=null!=(t=e)&&null!=(t=t.parameters)?t.macroParams:t;return n===s?`${n}${l(a)}`:n},l=e=>{var t,n,a,r;return"true"===(null!=(r=e)&&null!=(r=r.count)?r.value:r)?"-issue-count":(null!=(a=e)?a.columns:a)&&(null!=(n=e)?n.maximumIssues:n)?"-table-view":(null!=(t=e)&&null!=(t=t.key)?t.value:t)?"-single-issue":""}},897599:(e,t,n)=>{n.d(t,{K:()=>s});var a=n(122551),r=n(405124),o=n.n(r);function s(e,t){(0,a.useEffect)(e,function(e){const t=(0,a.useRef)();o()(e,t.current)||(t.current=e);return t.current}(t))}},769544:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(991332),r=n(29298),o=n(122551),s=n(833486),c=n(917465),i=n(580241),l=n(861635);const u=["a.user-mention","a.confluence-userlink","a.userLogoLink","span.user-hover-trigger","img.confluence-userlink"];class d extends o.Component{constructor(...e){super(...e),(0,r.Z)(this,"renderPortal",(e=>{const{position:t}=this.props,n=e.props["data-account-id"];return e.props.href=(0,l.p)(e.props["data-account-id"],null,c.b),s.createPortal(o.createElement(i.t,{isAnonymous:!n,userId:n,position:t},o.createElement("a",(0,a.Z)({},e.props),e.props.children)),e.placeholder)}))}shouldComponentUpdate(e){return e.node!==this.props.node}getLegacyUserElements(){const{node:e}=this.props;return e?Array.from(e.querySelectorAll(u.join(","))):[]}render(){return(0,l.ns)(this.getLegacyUserElements()).map((e=>this.renderPortal(e)))}}d.displayName="LegacyUserElementsHover"},188358:(e,t,n)=>{n.d(t,{K:()=>s});var a=n(415911),r=n(616158),o=n(758724);(0,r.j)("wrm");function s(e,t,n=!1){if(!t.length)return Promise.resolve();const r=window.document.createDocumentFragment(),s=(0,o.Uh)(t,n).map((e=>{let{src:t}=e,n=(0,a.Z)(e,["src"]);return new Promise(((e,a)=>{if(window.document.querySelector(`script[data-wrm-key='${n["data-wrm-key"]}']`))e(null);else{const o=window.document.createElement("script");o.async=!1,o.src=t,o.onload=e,o.onerror=a,Object.keys(n).forEach((e=>o.setAttribute(e,n[e]))),r.appendChild(o)}}))}));return e.appendChild(r),Promise.all(s).catch(((...e)=>{0}))}}}]);
//# sourceMappingURL=19129.5yZmwwb3LF.js.map