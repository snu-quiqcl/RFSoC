WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-previews:confluence-previews-jquery', location = '/js/confluence/preview-support.js' */
define("cp/confluence/preview-support",["ajs"],function(b){var g=function(j){j.bridgeId=""+a(window);var h=window.location;var i=h.origin;if(!i){i=h.protocol+"//"+h.hostname+(h.port?":"+h.port:"")}window.parent.postMessage(j,i)};var d=function(i){var j=i.frameElement&&i.frameElement.getAttribute("name");var h=i.frameElement&&i.frameElement.getAttribute("data-is-fallback-mode-iframe")==="true";return j&&j==="fallback-mode-iframe"||h};var a=function(h){return h.frameElement&&h.frameElement.getAttribute("data-bridge-id")};var f=function(){var h=c.SELECTOR_STRINGS.IMAGE+", "+c.SELECTOR_STRINGS.LINK_IMAGE+", "+c.SELECTOR_STRINGS.EXTERNAL_IMAGE;if(c.isPDFSupported()){h+=", "+c.SELECTOR_STRINGS.PDF+", "+c.SELECTOR_STRINGS.LINK_PDF}return h};var e=function(){return c.SELECTOR_STRINGS.IMAGE+", "+c.SELECTOR_STRINGS.EXTERNAL_IMAGE+", "+c.SELECTOR_STRINGS.FILE+", "+c.SELECTOR_STRINGS.LINK_FILE+", "+c.SELECTOR_STRINGS.ATTACHMENT_MACRO};var c={SELECTOR_STRINGS:{IMAGE:"img.confluence-embedded-image[data-linked-resource-id]",EXTERNAL_IMAGE:"img.confluence-embedded-image.confluence-external-resource",PDF:"a.confluence-embedded-file[data-nice-type='PDF Document']",LINK_IMAGE:"a[data-linked-resource-type='attachment'][data-nice-type='Image']",LINK_PDF:"a[data-linked-resource-type='attachment'][data-nice-type='PDF Document']",FILE:"a.confluence-embedded-file",LINK_FILE:"a[data-linked-resource-type='attachment']",FILE_OVERLAY:"span.confluence-embedded-file-wrapper .file-type-desc-overlay, span.confluence-embedded-file-wrapper .comment-count-overlay",ATTACHMENT_MACRO:".plugin_attachments_container a.previewAttachmentLink"},VIEW_MODE:{FULL:"full",COMMENT:"comment",SIMPLE:"simple",EDIT:"edit"},isPDFSupported:function(){return b.DarkFeatures.isEnabled("pdf-preview")},areFilesSafe:function(h){var i=true;h.forEach(function(j){Object.keys(j).forEach(function(l){var k=typeof j[l];if(!(k==="string"||k==="number"||k==="boolean")){i=false}})});return i},getFileSelectorString:function(){if(b.DarkFeatures.isEnabled("previews.trigger-all-file-types")){return e()}else{return f()}},sendPreviewerToParent:function(j,i,h,k){var l=c.areFilesSafe(j||[]);g({type:"openPreviewOnParent",files:l?j:[],viewMode:i,fileQuery:h,analyticsSource:k})},autoShowAnnotationsOnParent:function(){g({type:"autoShowAnnotationsOnParent"})},isFallbackModeIframe:window.top!==window.self&&d(window)};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-previews:confluence-previews-jquery', location = '/js/confluence/preview.js' */
define("cp/confluence/preview",["underscore","jquery","cp/confluence/preview-support","ajs","confluence/jsUri"],function(m,g,h,k,d){var l,n,b=false;var c=g("#confluence-ui").length>0;g(document).ready(i);function i(){var q=g(h.getFileSelectorString());q.off("click.fb");var r=g(document.body);r.off("click.filePreviews");r.on("click.filePreviews",h.getFileSelectorString(),p);r.on("click.filePreviews",h.SELECTOR_STRINGS.FILE_OVERLAY,j);g(window).on("popstate",function(){if(!n&&k.DarkFeatures.isEnabled("previews.sharing.pushstate")){a()}});if(!c){a()}}function p(q){if(!q.altKey&&!q.ctrlKey&&!q.metaKey&&!g(this).parent().closest("a, #draft-changes-dialog, #cp-annotations").length){q.preventDefault();o(this,g(q.currentTarget).data("preview-view-mode"))}}function j(r){r.preventDefault();var q=g(r.target);var s=q.closest("span.confluence-embedded-file-wrapper");o(s.find(h.SELECTOR_STRINGS.IMAGE+","+h.SELECTOR_STRINGS.FILE),undefined,undefined,q.closest(".comment-count-overlay").length>0)}function o(s,t,q,z){if(!n){var u="confluence-previews-css";var r="media-viewer";WRM.require("wr!com.atlassian.confluence.plugins.confluence-previews:"+u);var A=g.Deferred(),w=A.promise();var v=setInterval(function(){for(var D=0;D<document.styleSheets.length;D++){var E=document.styleSheets[D];if(E.href&&(E.href.indexOf(u)!==-1||E.href.indexOf(r)!==-1)){y();return}}},100);var y=function(){A.resolve();clearInterval(v)};var C=k.Meta.get("static-resource-url-prefix");var B="com.atlassian.confluence.plugins.confluence-previews:mediaviewer-chunks";var x=C+"/download/resources/"+B+"/";n=g.when(WRM.require(["wr!com.atlassian.confluence.plugins.confluence-previews:confluence-previews-js","wrc!media-viewer"]),w);n.done(function(){l=require("cp/confluence/file-preview-loader");if(!c||s&&!b){b=true;f(s,t,q,z)}k.bind("reset-file-list.filePreviews",l.resetPreviewFileList)});if(!h.isFallbackModeIframe){Confluence.PageLoadingIndicator(g("body")).showUntilResolved(n,"We were unable to load the file previewer")}}else{n.done(m.partial(f,s,t,q,z))}return n}var f=function(u,v,q,x){var s=g("#content");var r=g(u).closest(".comment,.comment-content,.cq-content,.ic-content");if(!v){var y=k.Meta.get("content-type");var t=s.hasClass("page")||y==="page";var w=s.hasClass("blogpost")||y==="blogpost";var z=g(".files-tab-identifier").length;if(!t&&!w&&!z){v=h.VIEW_MODE.SIMPLE}else{if(r.length){v=h.VIEW_MODE.COMMENT}}}if(v===h.VIEW_MODE.COMMENT){l.showPreviewerForComment(u,r,v,x)}else{if(v===h.VIEW_MODE.SIMPLE){l.showPreviewerForSingleFile(u,v,q)}else{if(v===h.VIEW_MODE.EDIT){l.fetchAndShowPreviewerForSingleFile(u,h.VIEW_MODE.SIMPLE,q)}else{v=h.VIEW_MODE.FULL;l.showPreviewer(undefined,u,v,x)}}}};function a(){if(e()){var u=new d(window.location.href);var s=window.history.pushState&&k.DarkFeatures.isEnabled("previews.sharing.pushstate");var r=window.history.replaceState;var t=u.getQueryParamValue("preview");if(t&&!s){var v="#!/preview"+t;var q=decodeURIComponent(u.deleteQueryParam("preview").setAnchor(v).toString());if(r){r({},"",q)}else{window.location=q}}else{if(u.anchor().indexOf("!/preview")===0&&s){var q;if(t){q=u.setAnchor("")}else{q=u.addQueryParam("preview",u.anchor().substr("!/preview".length,u.anchor().length)).setAnchor("")}r({},"",q)}}o()}}function e(){var q=new d(window.location.href);return k.DarkFeatures.isEnabled("previews.sharing")&&(q.getQueryParamValue("preview")||(q.anchor()&&q.anchor().indexOf("!/preview")===0))}return{loadConfluencePreviews:o}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-previews:confluence-previews-jquery', location = '/js/confluence/jquery-previewer.js' */
require(["cp/confluence/preview","jquery"],function(b,a){a.fn.previewer=function(c){if(!a(this).length){return this}var d=a.extend({},c);return this.each(function(){var f=a(this);var e=f.closest("li");var g=d.src||f.attr("data-image-src")||f.attr("src");if(g){f.click(function(j){var i={src:g,type:d.type,thumbnail:g,title:d.title||e.attr("data-file-name")||g,id:e.attr("data-attachment-id"),ownerId:e.attr("data-owner-id")};var h=b.loadConfluencePreviews([i],d.viewMode||"simple",d.from||"custom");d.zindex&&h.done(function(){a(".cp-container").css({"z-index":d.zindex})})})}})}});
}catch(e){WRMCB(e)};