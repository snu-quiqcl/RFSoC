WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:customeventtype-edit', location = 'com/atlassian/confluence/extra/calendar3/components/customeventype/customeventtype-model.js' */
define("tc/customeventtype-model",["jquery","tc-backbone"],function(b,c){var a=c.Model.extend({defaults:function(){return{title:"",icon:"",subCalendar:"",disable:false,isCustomEvent:false,id:"",created:"",periodInMins:""}},validate:function(d){if(!d.isCustomEvent){return false}var e=[];if(!d.title){e.push({field:"title",message:"Event name is required"})}d.title=b.trim(d.title);if(d.title.length<=0){e.push({field:"title",message:"Event name is required"})}else{if(d.title.length>256){e.push({field:"title",message:"Event name should be less than or equal to 256 characters"})}}if(!d.icon){e.push({field:"icon",message:"Event icon is required"})}return e.length>0?e:false},toggle:function(){this.set({disable:!this.get("disable")})}});return a});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:customeventtype-edit', location = 'com/atlassian/confluence/extra/calendar3/components/customeventype/customeventtype-edit/customeventtype-edit.soy' */
// This file was automatically generated from customeventtype-edit.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.TeamCalendars.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.TeamCalendars == 'undefined') { Confluence.TeamCalendars = {}; }
if (typeof Confluence.TeamCalendars.Templates == 'undefined') { Confluence.TeamCalendars.Templates = {}; }


Confluence.TeamCalendars.Templates.editCustomEventType = function(opt_data, opt_ignored) {
  return '<tr id="edit-custom-event-type-form"><td colspan="3"><div class="aui-message warning tooltip-warning hidden"><span class="title"><span class="aui-icon icon-warning"></span>' + soy.$$escapeHtml('Save or cancel your custom event type before continuing.') + '</span></div><form class="aui form-add-custom">' + ((opt_data.isCustomEventType) ? '<fieldset class="field-group custom-event-title"><label for="event-title">' + soy.$$escapeHtml('Event Name') + '<span class="aui-icon icon-required">required</span></label><input class="text medium-field" type="text" id="custom-eventtype-title" name="event-title" title="Event Title" value="' + soy.$$escapeHtml(opt_data.title) + '"/><p class="hidden error custom_event_type_field_error" data-field-name="title"></p></fieldset><fieldset class="field-group select-avatar tc-event-type-item"><label for="event-title">' + soy.$$escapeHtml('Event Icon') + '<span class="aui-icon icon-required">required</span></label><div class = "custom-eventtype-icons"><button class="' + ((opt_data.icon == 'campaign') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals campaign" data-icon = "campaign"></span></button><button class="' + ((opt_data.icon == 'conference') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals conference" data-icon = "conference"></span></button><button class="' + ((opt_data.icon == 'deployment') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals deployment" data-icon = "deployment" ></span></button><button class="' + ((opt_data.icon == 'home') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals home" data-icon = "home"></span></button><button class="' + ((opt_data.icon == 'marketing_email') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals marketing_email" data-icon = "marketing_email"></span></button><button class="' + ((opt_data.icon == 'meeting') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals meeting" data-icon = "meeting"></span></button><button class="' + ((opt_data.icon == 'milestone') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals milestone" data-icon = "milestone"></span></button><button class="' + ((opt_data.icon == 'outage') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals outage" data-icon = "outage"></span></button><button class="' + ((opt_data.icon == 'party') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals party" data-icon = "party"></span></button><button class="' + ((opt_data.icon == 'sporting_event') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals sporting_event" data-icon = "sporting_event"></span></button><button class="' + ((opt_data.icon == 'testing') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals testing" data-icon = "testing"></span></button><button class="' + ((opt_data.icon == 'training') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals training" data-icon = "training"></span></button><button class="' + ((opt_data.icon == 'workshop') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals workshop" data-icon = "workshop"></span></button><button class="' + ((opt_data.icon == 'events') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals events" data-icon = "events"></span></button><button class="' + ((opt_data.icon == 'travel') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals travel" data-icon = "travel"></span></button><!--<button class="' + ((opt_data.icon == 'birthdays') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals birthdays" data-icon = "birthdays"></span></button>--><button class="' + ((opt_data.icon == 'leaves') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals leaves" data-icon = "leaves"></span></button><button class="' + ((opt_data.icon == 'jira_box') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals jira_box" data-icon = "jira_box"></span></button><button class="' + ((opt_data.icon == 'sprints') ? 'selected' : '') + '"><span class="aui-icon icon-teamcals sprints" data-icon = "sprints"></span></button></div><p class="hidden error custom_event_type_field_error" data-field-name="icon"></p></fieldset>' : '<fieldset class="field-group"><span class="event-type-link" title="' + soy.$$escapeHtml(opt_data.title) + '"><span class="' + soy.$$escapeHtml(opt_data.icon) + '"></span><span class="event-type-label">' + soy.$$escapeHtml(opt_data.title) + '</span></span></fieldset>') + '<fieldset><div class="field-group"><label for="dBase">' + soy.$$escapeHtml('Reminder') + '</label><select class="select" id="period-reminder" name="period" title="database select"><option value="0" ' + ((opt_data.periodInMins == 0) ? 'selected' : '') + '>' + soy.$$escapeHtml('None') + '</option><option value="5" ' + ((opt_data.periodInMins == 5) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} minutes','5')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="10" ' + ((opt_data.periodInMins == 10) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} minutes','10')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="20" ' + ((opt_data.periodInMins == 20) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} minutes','20')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="30" ' + ((opt_data.periodInMins == 30) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} minutes','30')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="60" ' + ((opt_data.periodInMins == 60) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} hour','1')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="120" ' + ((opt_data.periodInMins == 120) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} hours','2')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="240" ' + ((opt_data.periodInMins == 240) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} hours','4')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="480" ' + ((opt_data.periodInMins == 480) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} hours','8')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="1440" ' + ((opt_data.periodInMins == 1440) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} day','1')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="2880" ' + ((opt_data.periodInMins == 2880) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} days','2')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="4320" ' + ((opt_data.periodInMins == 4320) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} days','3')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="10080" ' + ((opt_data.periodInMins == 10080) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} week','1')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="20160" ' + ((opt_data.periodInMins == 20160) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} weeks','2')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="30240" ' + ((opt_data.periodInMins == 30240) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} weeks','3')) + ' ' + soy.$$escapeHtml('before') + '</option><option value="40320" ' + ((opt_data.periodInMins == 40320) ? 'selected' : '') + '>' + soy.$$escapeHtml(AJS.format('{0} weeks','4')) + ' ' + soy.$$escapeHtml('before') + '</option></select></div></fieldset><div class="event-type-info"><div class="tc-aui-help-content"><div class="event-type-info-text"><span>' + soy.$$escapeHtml('Changes will affect everyone that uses this calendar; including reminder times.') + '</span></div></div></div><span class="buttons-container"><span class="buttons"><input class="button button-panel-button save" tabindex="30" type="button" value="' + soy.$$escapeHtml('Save') + '" id="save-custom-event-type"><a class="cancel" tabindex="31"  href="#">Cancel</a></span></span></form></td></tr>';
};
if (goog.DEBUG) {
  Confluence.TeamCalendars.Templates.editCustomEventType.soyTemplateName = 'Confluence.TeamCalendars.Templates.editCustomEventType';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:customeventtype-edit', location = 'com/atlassian/confluence/extra/calendar3/components/customeventype/customeventtype-edit/customeventtype-edit.js' */
define("tc/customeventtype-edit",["jquery","underscore","tc-backbone"],function(c,a,d){var b=d.View.extend({parentCustomEventTypeDiv:null,mediator:null,isOpen:null,events:{"click input.save":"_updateCustomEventType","click a.cancel":"_closeInlineDialog","click .select-avatar button":"_selectIconCustomEventType",keydown:"handleKey"},initialize:function(e){if(!e){return}this.mediator=e.mediator;this.parentCustomEventTypeDiv=e.parentCustomEventTypeDiv;this.model.on("invalid",a.bind(this._handleError,this));this.mediator.on("Custom-Event-Type.edit.open",a.bind(this.shouldRemoveMe,this));this.mediator.trigger("Custom-Event-Type.edit.open",this)},render:function(){var e=this;var f=e.model.get("isCustomEvent")===true;c(".custom-event-type-items-instructional").addClass("hidden");c(e.parentCustomEventTypeDiv).addClass("hidden");c(e.parentCustomEventTypeDiv).after(Confluence.TeamCalendars.Templates.editCustomEventType({title:e.model.get("title"),icon:e.model.get("icon"),periodInMins:e.model.get("periodInMins"),isCustomEventType:f}));e.$editCustomEventTypeForm=c("#edit-custom-event-type-form");e.el=e.$editCustomEventTypeForm;e.$el=c(e.el);e.delegateEvents();e.$editCustomEventTypeForm.find(".custom-event-title input").focus();this.isOpen=true},shouldRemoveMe:function(){if(this.isOpen){this.remove()}},remove:function(){this._closeInlineDialog()},handleKey:function(f){if(f.which===13){f.preventDefault();f.stopPropagation();this._updateCustomEventType()}if(f.which===27){f.preventDefault();f.stopPropagation();this._closeInlineDialog()}},_closeInlineDialog:function(){c(this.parentCustomEventTypeDiv).removeClass("hidden");if(this.model.collection&&this.model.collection.customEventTypes().length===0){c(".custom-event-type-items-instructional").removeClass("hidden")}this.$editCustomEventTypeForm.remove()},_updateCustomEventType:function(){this.$editCustomEventTypeForm.find(".custom_event_type_field_error").each(function(l,m){var k=c(m);if(!k.hasClass("hidden")){k.addClass("hidden")}});var j=this.$editCustomEventTypeForm.find(".custom-event-title input").val();var f=this.$editCustomEventTypeForm.find(".select-avatar button.selected span").data("icon");var e=this.$editCustomEventTypeForm.find("#period-reminder").val();var h=this.model.get("title");var g=this.model.get("icon");var i=this.model.get("periodInMins");this.model.set({title:j!==undefined?j:h,icon:f!==undefined?f:g,periodInMins:e});if(!this.model.isValid()){this.model.set({title:h,icon:g,periodInMins:i});return}this.mediator.trigger("Custom-Event-Type.save",this.model);this._closeInlineDialog()},_handleError:function(f,h){var g=this;var e=function(j){var i=a.where(h,{field:j});if(i.length>0){return i[0].message}return""};this.$editCustomEventTypeForm.find(".custom_event_type_field_error").each(function(j,k){var i=c(k);var l=i.data("field-name");i.html(e(l));if(i.hasClass("hidden")){i.removeClass("hidden")}if(l==="title"){g.$editCustomEventTypeForm.find("#custom-eventtype-title").focus()}})},_selectIconCustomEventType:function(e){if(!e){e=window.event}e.preventDefault();c(".select-avatar.tc-event-type-item button").removeClass("selected");var f=e.target||e.srcElement;if(f.nodeName==="SPAN"){c(f).parent().addClass("selected")}else{c(f).addClass("selected")}}});return b});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:customeventtype-edit', location = 'com/atlassian/confluence/extra/calendar3/components/customeventype/customeventtype-edit/customeventtype-edit-compat.js' */
require(["tc/customeventtype-edit","tc/customeventtype-model"],function(a,b){if(!Confluence.TeamCalendars.Dialogs){Confluence.TeamCalendars.Dialogs={}}Confluence.TeamCalendars.Dialogs.getCustomEventTypeEdit=function(f,c){var e=$(f).parent().parent();var g=$(e).find("span.custom-event-type").data();var d=new b({title:g.title,icon:g.icon,subCalendar:c,periodInMins:g.periodInMins});return new a({parentCustomEventTypeDiv:e,dataCustomEventType:g,model:d}).render()}});
}catch(e){WRMCB(e)};