WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:user-group-select2', location = '/js/user-group-select2.js' */
define("confluence-ui-components/js/user-group-select2",["ajs","confluence/legacy","jquery","confluence/api/constants"],function(b,e,c,a){function d(g){g=g||document.body;var f=function(){var h=c(".select2-drop-active > .select2-results");if(h.children(".select2-result-selectable").length===0&&h.children(".select2-disabled").length){h.append('<li class="select2-no-results">'+b.escapeHtml("No matches found")+"</li>")}};c("input.autocomplete-multiusergroup[data-autocomplete-bound != 'true']",g).each(function(){var h=c(this);h.attr("data-autocomplete-bound","true");var j=h.attr("data-include-groups");var i=a.CONTEXT_PATH+"/images/icons/profilepics/default.png";h.auiSelect2({multiple:true,minimumInputLength:2,formatInputTooShort:function(){return j?"Start typing to search for a user or group":"Start typing to search for a user"},ajax:{transport:function(n){var o=n.success;delete n.success;return c.ajax.apply(c.ajax,arguments).done(o).done(f)},data:function(n){return{"max-results":6,query:n}},dataType:"json",url:e.getContextPath()+"/rest/prototype/1/search/user"+(j?"-or-group":"")+".json",results:function(o){var n=[];c.each(o.result,function(){if(this.type==="user"&&j&&this.accountId){n.push({id:this.accountId,accountId:this.accountId,text:this.title,imgSrc:this.thumbnailLink&&this.thumbnailLink.href?this.thumbnailLink.href:i,entity:this})}else{if(this.type==="user"){n.push({id:this.username,text:this.title,imgSrc:this.thumbnailLink&&this.thumbnailLink.href?this.thumbnailLink.href:i,entity:this})}else{n.push({id:this.name,text:this.name,imgSrc:a.CONTEXT_PATH+"/images/icons/avatar_group_48.png",entity:this})}}});return{results:n}},quietMillis:300},formatResult:function(n){if(n.accountId){return e.UI.Components.UserSelect2.avatarWithNameAccountId({size:"xsmall",displayName:n.text,userId:n.accountId,avatarImageUrl:n.imgSrc})}return e.UI.Components.UserGroupSelect2.avatarWithName({size:"xsmall",displayName:n.text,userId:n.id,avatarImageUrl:n.imgSrc})},escapeMarkup:function(n){return n},formatSelection:function(n){if(n.accountId){return e.UI.Components.UserSelect2.avatarWithNameAccountId({size:"xsmall",displayName:n.text,userId:n.accountId,avatarImageUrl:n.imgSrc})}return e.UI.Components.UserGroupSelect2.avatarWithName({size:"xsmall",displayName:n.text,userId:n.id,avatarImageUrl:n.imgSrc})},dropdownCssClass:"users-dropdown",containerCssClass:"users-autocomplete",hasAvatar:true});if(!h.data("autofill-user")){return}var m=b.Meta.get("remote-user"),l=b.Meta.get("current-user-fullname"),k=b.Meta.get("current-user-avatar-uri-reference");if(m&&l&&k){h.auiSelect2("data",[{id:m,accountId:b.Meta.get("atlassian-account-id"),text:l,imgSrc:k}])}})}return{bind:d}});
}catch(e){WRMCB(e)};