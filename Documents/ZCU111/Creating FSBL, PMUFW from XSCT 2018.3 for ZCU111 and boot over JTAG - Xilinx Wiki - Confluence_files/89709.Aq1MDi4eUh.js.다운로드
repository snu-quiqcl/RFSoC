"use strict";(self._cf=self._cf||[]).push([[89709],{821883:(t,e,r)=>{r.d(e,{B1:()=>i,JU:()=>n,hq:()=>s,tK:()=>a});const i="/gateway/api/graphql";let n,s,a;!function(t){t.VIEWED="viewed"}(n||(n={})),function(t){t.COMMENTED="commented",t.CREATED="created",t.EDITED="edited",t.PUBLISHED="published",t.UPDATED="updated"}(s||(s={})),function(t){t.BLOGPOST="BLOGPOST",t.COMMENT="COMMENT",t.ISSUE="ISSUE",t.PAGE="PAGE",t.PROJECT="PROJECT",t.SITE="SITE",t.SPACE="SPACE",t.TASK="TASK"}(a||(a={}))},307445:(t,e,r)=>{r.d(e,{o:()=>u});var i=r(991332),n=r(160604),s=r(165675),a=r(486392),o=r(485255);const c=["FetchedActivities","TransformedActivityItems","GeneratedQueryWithFilters"].map((t=>({key:t,startMark:`${t}_start`,endMark:`${t}_end`}))),l=()=>new a.Q("client",{type:o.Z.Load,performanceType:o.R.Custom,platform:{component:"recent-work"},timings:c}),d=()=>new a.Q("client-v3",{type:o.Z.Load,performanceType:o.R.Custom,platform:{component:"recent-work"},timings:c});async function u(t,e){const r="v2"===e?l():d();try{r.start(),r.addMetadata({clientVersion:e,packageName:s.u2,packageVersion:s.i8});const i=await t(r);return r.success(),i}catch(i){throw r.failure({metadata:{error:p(i)}}),i}}const p=t=>{var e;return t instanceof n.Z?(0,i.Z)((0,i.Z)({},t),{},{xRequestId:null!==(e=t.xRequestId)&&void 0!==e?e:void 0,cause:void 0}):t instanceof Error?(0,i.Z)((0,i.Z)({},t),{},{cause:void 0}):"unknown"}},831243:(t,e,r)=>{r.d(e,{r:()=>s});var i=r(435020),n=r.n(i);const s=t=>`${(t=>n()(t))(t)}_activity_recentWorkClient`},467178:(t,e,r)=>{r.d(e,{y:()=>v});var i=r(415911),n=r(991332);const s=(t={},e,r)=>Object.entries(t).reduce(((t,[i,s])=>{const a=e?e(i,s):{[i]:s};return null!=r&&r.includes(i)?(0,n.Z)((0,n.Z)({},t),a):(0,n.Z)((0,n.Z)({},t),{},{arguments:(0,n.Z)((0,n.Z)({},t.arguments),a)})}),{type:"AND",arguments:{}}),a=["products","eventTypes","objectTypes"],o=new Map([["actors","accountIds"]]),c=(t={})=>s(t,((t,e)=>{const r=Array.isArray(e)&&a.includes(t)?e.map((t=>t.toUpperCase())):e;return{[o.has(t)?o.get(t):t]:r}})),l=new Map([["myActivity",(t={})=>{const{limit:e,actors:r}=t,n=(0,i.Z)(t,["limit","actors"]);return c(n)}],["activities",(t={})=>{const{limit:e}=t,r=(0,i.Z)(t,["limit"]);return c(r)}]]),d=["products","eventTypes","objectTypes"],u=["actors","rootContainerIds"],p=(t={})=>s(t,((t,e)=>Array.isArray(e)&&d.includes(t)?{[t]:e.map((t=>t.toLowerCase()))}:{[t]:e}),u),v={v2:l,v3:new Map([["myActivity",(t={})=>{const{limit:e,actors:r}=t,n=(0,i.Z)(t,["limit","actors"]);return p(n)}],["activities",(t={})=>{const{limit:e}=t,r=(0,i.Z)(t,["limit"]);return p(r)}]])}},590560:(t,e,r)=>{r.d(e,{t:()=>s});var i=r(29298),n=r(821883);class s{constructor(t,e,r,s){(0,i.Z)(this,"product","unknown"),(0,i.Z)(this,"baseUrl",n.B1),e&&(this.product=e),this.clientVersion=t,this.headers=null!=r?r:{},s&&(this.baseUrl=s)}}},289709:(t,e,r)=>{r.d(e,{r:()=>A});var i=r(29298),n=r(307445),s=r(590560),a=r(415911),o=r(831243),c=r(622236),l=r(467178);const d="\n  nodes {\n    id\n    timestamp\n    object {\n      id\n      name\n      cloudId\n      localResourceId\n      product\n      type\n      url\n      iconUrl\n      containers {\n        name\n      }\n      contributors {\n        profile {\n          accountId\n          name\n          picture\n        }\n      }\n      events {\n        eventType\n      }\n      extension {\n        ... on ActivitiesJiraIssue {\n          issueKey\n        }\n      }\n    }\n  }\n",u=new Map([["workedOn",`\n   workedOn(first: $first, filters: $filters) {\n     ${d}\n   }\n`],["viewed",`\n   viewed(first: $first, filters: $filters) {\n     ${d}\n   }\n`],["all",`\n    all(first: $first, filters: $filters) {\n      ${d}\n    }\n`]]),p=(t,e)=>`\n    query ${(0,o.r)(t)}($first: Int, $filters: [ActivitiesFilter!]) {\n      activities {\n        ${e}\n      }\n    }\n`;function v(t,e={}){return e&&e.nodes?e.nodes.map((e=>{const{object:r,timestamp:i}=e,{cloudId:n,events:s,extension:a,iconUrl:o,id:c,localResourceId:l,name:d,product:u,url:p,type:v}=r,y=s[0].eventType.toLowerCase(),m=a&&a.issueKey;let f=[];return m&&f.push({name:m}),Array.isArray(r.containers)&&(f=f.concat(r.containers)),f=f.filter((t=>!!t.name)),{query:t,containers:f,contributors:(r.contributors||[]).reduce(((t,e)=>{if(e.profile){const{accountId:r,picture:i}=e.profile;t.push({accountId:r,name:e.profile.name,picture:i})}return t}),[]),eventType:y,object:{rootContainerIdentifier:{id:n,type:"SITE",ari:`ari:cloud:platform::site/${n}`},deduplicateId:c,icon:{type:"URL",value:o},id:c,localResourceId:l,name:d,product:u,subProduct:null,type:v,url:p},timestamp:i}})):[]}const y=50,m=["teamCentral","editor","people","jira","townsquare","apOnboarding","worklens","confluence","start"],f=async({experience:t,product:e,retryMS:r,filters:i={},activityQueries:n,baseUrl:s})=>{var d;const{limit:f=y}=i,h=(0,a.Z)(i,["limit"]);t.mark("GeneratedQueryWithFilters_start");const{query:g,queryFilters:w}=((t,e,r)=>{if(Array.isArray(e.actors)){const i=r.filter((t=>"viewed"!==t));return{query:p(t,i.map((t=>u.get(t))).join("\n")),queryFilters:l.y.v2.get("activities")(e)}}return{query:p(t,(i=r.map((t=>u.get(t))),`\n      myActivities {\n        ${i.join("\n")}\n      }\n`)),queryFilters:l.y.v2.get("myActivity")(e)};var i})(e,h,n);t.mark("GeneratedQueryWithFilters_end");const A=m.includes(e)?e:"start";let E;t.mark("FetchedActivities_start");try{E=await(0,c.J)(s,{operationName:(0,o.r)(A),query:g,variables:{first:f,filters:w}},r)}catch(O){if(!O||401!==O.statusCode&&"The operation was aborted."!==O.message)throw O}t.mark("FetchedActivities_end");let I=[],k=[],C=[];return E&&null!==(d=E.data)&&void 0!==d&&d.activities?(t.mark("TransformedActivityItems_start"),void 0!==E.data.activities.myActivities?(E.data.activities.myActivities.workedOn&&n.includes("workedOn")&&(I=v("workedOn",E.data.activities.myActivities.workedOn)),E.data.activities.myActivities.viewed&&n.includes("viewed")&&(k=v("viewed",E.data.activities.myActivities.viewed)),E.data.activities.myActivities.all&&n.includes("all")&&(C=v("all",E.data.activities.myActivities.all))):(E.data.activities.workedOn&&n.includes("workedOn")&&(I=v("workedOn",E.data.activities.workedOn)),E.data.activities.all&&n.includes("all")&&(C=v("all",E.data.activities.all))),t.mark("TransformedActivityItems_end"),{all:C,viewed:k,workedOn:I}):{all:C,workedOn:I,viewed:k}};class h extends s.t{constructor(t,e){super("v2",t,void 0,e),(0,i.Z)(this,"fetchActivities",(async(t,e,r)=>(0,n.o)((i=>f({experience:i,product:this.product,retryMS:t,filters:e,activityQueries:r,baseUrl:this.baseUrl})),"v2"))),(0,i.Z)(this,"setProduct",(t=>{this.product=t}))}}var g=r(876646);let w;const A=(t,e,r,i,n)=>(w&&w!==t&&null!=r&&r.captureWarning&&r.captureWarning("ActivityClient version has changed, is this intentional?"),w=t||"v3","v2"===t?new h(e,i):new g.h(e,i,r,n))},876646:(t,e,r)=>{r.d(e,{h:()=>z});var i=r(991332),n=r(29298),s=r(6982),a=r(821883),o=r(165675),c=r(307445),l=r(622236);class d extends Error{constructor(t){super(t),this.name="GraphQLFragmentError",this.message=t}}class u extends Error{constructor(t){super(t.message),this.name="GraphQLJSError",this.error=t,this.message=t.message}}class p extends Error{constructor(t){super(),this.name="GraphQLNoResultsError",this.errors=t,this.message="GraphQL returned errors & no results",this.errorMessages=t.map((t=>t.message))}}var v=r(49471),y=r.n(v);class m extends Error{constructor({error:t,message:e}){super();const r=t instanceof Error?t:new Error;this.name="HydratorError",this.message=e,this.originalMessage=r.message,this.stack=r.stack,this.originalName=r.name}}function f(t,e){if(!t)return t;if(e.includes(":")){const[r,i]=e.split(":");return function(t,e,r){return t.find((t=>y()(t,e)===r))}(t,r.trim(),i.trim().replace(/"/g,""))}return y()(t,e)}function h(t,e){return e.map((e=>function(t,e){const r=e.split(/\(|\)./);let i=t;for(const n of r)i=f(i,n);return i}(t,e)))}const g=(t,e)=>{const{hydratorPaths:r,staticFallbacks:n}=e;return(0,i.Z)({staticFallbacks:n},Object.entries(r).reduce(((e,[r,i])=>{const n=h(t,i);if(!n)throw new Error(`Bad hydrator path: ${r}`);return e[r]=n,e}),{}))},w=(t,e="")=>t?Array.isArray(t)?t.join(e):t:null;function A(t){return"string"==typeof t}function E(t){return"object"==typeof t&&void 0!==t.value&&!!t.value}const I=(t,e,r)=>{switch(t){case"ConfluenceBlogPost":return k(e,r,"confluenceBlogIcon")||k(e,r);case"ConfluencePage":return k(e,r,"confluencePageIcon")||k(e,r);default:return k(e,r)}},k=(t,e,r="icon")=>{if(Array.isArray(t)&&t.length>0){const i=t.filter(E);if(i.length>0)return{type:"EMOJI",value:i[0].value,fallback:null==e?void 0:e[r]};const n=t.filter(A);if(n.length>0){const t=w(n);if(null!==t)return{type:"URL",value:t}}}return e&&r in e&&e[r]?{type:"URL",value:e[r]}:null};var C=r(615394),O=r(590560);const Z=new RegExp(/^Validation error.*?@ '(\w+)/),$=new Map([["ValidationError",t=>{const e=Z.exec(t.message);if(Array.isArray(e)){const t=e[1];if(t)return t}return null}]]),T=t=>{const e=$.get(t.extensions.classification);return"function"==typeof e?e(t):null};var b=r(415911),x=r(831243),_=r(467178);const M=50,q=new Map([["workedOn","\n   workedOn(first: $first, filter: $filter) {\n     ...activityItemConnection\n   }\n"],["viewed","\n   viewed(first: $first, filter: $filter) {\n     ...activityItemConnection\n   }\n"],["all","\n    all(first: $first, filter: $filter) {\n      ...activityItemConnection\n    }\n"]]),j=(t,e,r,i="ActivityFilter")=>`\n    query ${(0,x.r)(t)}($first: Int, $filter: ${i}) {\n      activity {\n        ${e}\n      }\n    }\n${r}\n`,S=(t,e,r,i)=>{const{limit:n=M}=e,s=(0,b.Z)(e,["limit"]),{query:a,queryFilters:o}=((t,e,r,i)=>{if(Array.isArray(e.actors)){const n=r.filter((t=>"viewed"!==t));return{query:j(t,n.map((t=>q.get(t))).join("\n"),i,"ActivityFilter"),queryFilters:_.y.v3.get("activities")(e)}}return{query:j(t,(n=r.map((t=>q.get(t))),`\n      myActivity {\n        ${n.join("\n")}\n      }\n`),i,"MyActivityFilter"),queryFilters:_.y.v3.get("myActivity")(e)};var n})(t,s,r,i);return{operationName:(0,x.r)(t),query:a,variables:{first:n,filter:o}}};function F(t){const e=t.reduce(((t,e)=>{const r=e.object.deduplicateId||e.object.id,i=t[r];if(i){const n=i.aggregatedActivityItems||[];Date.parse(i.timestamp)<Date.parse(e.timestamp)?(e.aggregatedActivityItems=[...n,i],delete t[r],t[r]=e):t[r].aggregatedActivityItems=[...n,e]}else t[r]=e;return t}),{});return Object.values(e)}const R=t=>t.charAt(0).toLowerCase()+t.slice(1),P=t=>t.charAt(0).toUpperCase()+t.slice(1),U=t=>t.myActivity?t.myActivity:t,L=new Map([["ari:cloud:platform::site/","SITE"]]);function Q(t){const e=t.indexOf("/");return{ari:t,id:t.slice(e+1),type:L.get(t.slice(0,e+1))||"OTHER"}}function G(t){var e,r,n,s,a,o;return(0,i.Z)((0,i.Z)({},t),{},{actors:null===(e=t.actors)||void 0===e?void 0:e.length,containerIds:null===(r=t.containerIds)||void 0===r?void 0:r.length,products:null===(n=t.products)||void 0===n?void 0:n.join(","),eventTypes:null===(s=t.eventTypes)||void 0===s?void 0:s.join(","),objectTypes:null===(a=t.objectTypes)||void 0===a?void 0:a.join(","),rootContainerIds:null===(o=t.rootContainerIds)||void 0===o?void 0:o.join(",")})}const N=["activity","all","myActivity","workedOn","viewed","activityItemConnection","activityItemEdge"];function D(t,e){return t.filter((t=>!N.includes(t))).reduce(((t,e)=>{return t.replace(new RegExp(`...${e}\n`,"g"),"").replace((r=e,new RegExp(`fragment ${R(r)} on ${P(r)} ({(.|\\n)+?(?=fragment))`,"gm")),"");var r}),e)}const J=["IncorrectAuthException"];function W(t){if(null==t||!t.data||!Array.isArray(t.errors))return!1;return t.errors.filter((t=>!t.extensions.classification||!J.includes(t.extensions.classification))).length>0&&(!(e=t.data).activity||0===(null===(r=U(e.activity).all)||void 0===r||null===(i=r.edges)||void 0===i?void 0:i.length)&&0===(null===(n=U(e.activity).workedOn)||void 0===n||null===(s=n.edges)||void 0===s?void 0:s.length)&&0===(null===(a=e.activity)||void 0===a||null===(o=a.myActivity)||void 0===o||null===(c=o.viewed)||void 0===c||null===(l=c.edges)||void 0===l?void 0:l.length));var e,r,i,n,s,a,o,c,l}const H=["ConfluenceComment","ConfluenceFooterComment","ConfluenceInlineComment"],V=new Map([[401,[/.*/]],[403,[/Invalid CORS request/]]]),B=["The operation was aborted."],K={source:o.u2,sourcePackageVersion:o.i8};class z extends O.t{constructor(t,e,r,a){super("v3",t,{"X-ExperimentalApi":"ActivityV3Api"},e),(0,n.Z)(this,"setProduct",(t=>{this.product=t})),(0,n.Z)(this,"captureException",((t,e)=>{this.clientHandlers&&this.clientHandlers.captureException(t,(0,i.Z)((0,i.Z)({},K),e))})),(0,n.Z)(this,"captureWarning",((t,e)=>{this.clientHandlers&&this.clientHandlers.captureWarning(t,(0,i.Z)((0,i.Z)({},K),e))})),(0,n.Z)(this,"fetchHydratorConfig",(async()=>await this.hydratorConfigClient.fetchConfig())),(0,n.Z)(this,"handleGraphQLErrors",(t=>{const e=[];if(Array.isArray(t)){for(const r of t){this.captureException(new u(r));const t=T(r);t&&e.push(t)}return e}return[]})),(0,n.Z)(this,"fetchActivitiesV3",(async(t,e,r,n,a=!0)=>{var o,c,u,v,y,m,f,h;let g,{fragments:w,hydrators:A}=await this.fetchHydratorConfig();t.mark("GeneratedQueryWithFilters_start");try{g=await(0,s.AQ)((async()=>{const s=S(this.product,r,n,w);t.mark("GeneratedQueryWithFilters_end"),t.mark("FetchedActivities_start"),t.addMetadata({filters:G(r)});const a=await(0,l.J)(this.baseUrl,s,e,(0,i.Z)({},this.headers));t.mark("FetchedActivities_end");const o=this.handleGraphQLErrors(null==a?void 0:a.errors);if(o.length>0)throw w=D(o,w),new d(`Missing fragments: [${o.toString()}]`);return a}),{intervalsMS:[0,0,0],retryOn:t=>[d].some((e=>t instanceof e)),captureException:this.captureException})}catch(Z){var E;if(!Z||(null===(E=V.get(Z.statusCode))||void 0===E||!E.some((t=>t.test(Z.message))))&&!B.includes(Z.message))throw Z}if(W(g))throw new p(g.errors);if(!g||null===(o=g.data)||void 0===o||!o.activity)return{workedOn:[],viewed:[],all:[]};t.mark("TransformedActivityItems_start");const I=X("workedOn",(null===(c=U(g.data.activity))||void 0===c||null===(u=c.workedOn)||void 0===u?void 0:u.edges)||[],A,this.captureException),k=X("viewed",(null===(v=g.data.activity)||void 0===v||null===(y=v.myActivity)||void 0===y||null===(m=y.viewed)||void 0===m?void 0:m.edges)||[],A,this.captureException),C=X("all",(null===(f=U(g.data.activity))||void 0===f||null===(h=f.all)||void 0===h?void 0:h.edges)||[],A,this.captureException);t.mark("TransformedActivityItems_end");const O={viewed:k,workedOn:I,all:C};return a?function(t){const{all:e,viewed:r,workedOn:i}=t;return{all:F(e),viewed:F(r),workedOn:F(i)}}(O):O})),(0,n.Z)(this,"fetchActivities",(async(t,e,r,i=!0)=>(0,c.o)((n=>this.fetchActivitiesV3(n,t,e,r,i)),"v3"))),this.clientHandlers=r,this.hydratorConfigClient=new C.Z({captureException:this.captureException,captureWarning:this.captureWarning},t,a)}}function X(t,e,r,i){return e.reduce(((e,n)=>{if(n&&n.node&&n.node.object&&n.node.event){const{object:c,event:l}=n.node;if(!c.product||!c.type)return e;const d=[];const u=(c.contributors||[]).reduce(((t,e)=>{if(e.profile){const{accountId:r,picture:i}=e.profile;t.push({accountId:r,name:e.profile.name,picture:i})}return t}),[]),p=((t,e,r)=>{if(e)if("__typename"in e){const n=t[e.__typename];if(n)try{return g(e,n)}catch(i){r&&r(new m({error:i,message:`Hydrator failed for [${e.__typename}].`}))}else r&&r(new m({message:`Missing hydrator for [${e.__typename}].`}))}else r&&r(new m({message:"Missing [__typename] field from data."}));return null})(r,c.data,i);if(p){var s,o;p.key&&d.push({name:w(p.key," ")}),p.containers&&d.push({name:w(p.containers," ")});const r=l.actor?{name:l.actor.name,picture:l.actor.picture,accountId:l.actor.accountId}:void 0,i="comment"===c.type&&l.eventType===a.hq.CREATED?a.hq.COMMENTED:l.eventType;e.push({actor:r,query:t,containers:d,contributors:u,eventType:i,object:{rootContainerIdentifier:Q(c.rootContainerId),icon:H.includes(c.data.__typename)?I(null===(s=c.data)||void 0===s||null===(o=s.container)||void 0===o?void 0:o.__typename,p.icon,p.staticFallbacks):k(p.icon,p.staticFallbacks),id:c.id,deduplicateId:w(p.deduplicateId)||c.id,localResourceId:w(p.localResourceId),name:w(p.name," "),product:c.product,subProduct:c.subProduct,type:c.type,url:w(p.url)},timestamp:l.timestamp})}}return e}),[])}},160604:(t,e,r)=>{r.d(e,{Z:()=>i,D:()=>n});class i extends Error{constructor({message:t,statusCode:e,path:r,method:i,xRequestId:n,headers:s}){super(),this.name="HttpError",this.message=t;const a=r.split("?")[0];this.path=/^[/-a-z]+$/i.test(a)?a:"",this.method=i,this.statusCode=e,this.xRequestId=n,this.headers=Array.from(s.entries()).map(((t,e)=>`${e}:${t}`)).sort().join(",")}}const n=t=>t instanceof i},622236:(t,e,r)=>{r.d(e,{J:()=>l});var i=r(991332),n=r(648665),s=r(6982);const a=new RegExp(/^https?:\/\//);var o=r(160604);const c=async(t,e,r={})=>{const s=function(t,e={host:window.location.hostname,port:window.location.port}){return a.test(t)?t:"localhost"===e.host?`http://${e.host}:${e.port}${t}`:t}(t),c=await fetch(s,(0,i.Z)({credentials:"include",method:e},r)).catch((r=>{throw new n.Z({error:r,path:t,method:e})})),l=c.status;if(!c.ok){const r=function(t){let e;try{e=JSON.parse(t)}catch(r){return t}return delete e.timestamp,JSON.stringify(e)}(await c.text());throw new o.Z({message:r,method:e,path:t,statusCode:l,xRequestId:c.headers.get("x-request-id"),headers:c.headers})}return c},l=async(t,e,r,n)=>(0,s.AQ)((()=>(async(t,e,r={})=>{const i=await c(t,e,r),n=await i.text();return n?JSON.parse(n):{}})(t,"POST",{body:JSON.stringify(e),headers:(0,i.Z)({"content-type":"application/json"},n)})),{intervalsMS:null!=r?r:[]})},165675:t=>{t.exports=JSON.parse('{"u2":"@atlassian/recent-work-client","i8":"1.7.3"}')}}]);
//# sourceMappingURL=89709.Aq1MDi4eUh.js.map